<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-模板/技术设计模板">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">技术设计模板 | Hi. I&#x27;m NanXu.</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://doc.mvvm.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://doc.mvvm.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://doc.mvvm.io/docs/模板/技术设计模板"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="技术设计模板 | Hi. I&#x27;m NanXu."><meta data-rh="true" name="description" content="大家好，我是老三，转眼间，团队的技术专家B哥，已经离职一年了，我还时不时会想起他，因为他留下的j技术设计模版，我觉得真的很好用，基本上涵盖了设计需要考虑的方方面面。接下来，以一个CRM项目的用户触达模块为例，给大家分享一下。"><meta data-rh="true" property="og:description" content="大家好，我是老三，转眼间，团队的技术专家B哥，已经离职一年了，我还时不时会想起他，因为他留下的j技术设计模版，我觉得真的很好用，基本上涵盖了设计需要考虑的方方面面。接下来，以一个CRM项目的用户触达模块为例，给大家分享一下。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://doc.mvvm.io/docs/模板/技术设计模板"><link data-rh="true" rel="alternate" href="https://doc.mvvm.io/docs/模板/技术设计模板" hreflang="en"><link data-rh="true" rel="alternate" href="https://doc.mvvm.io/docs/模板/技术设计模板" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Hi. I&#39;m NanXu. RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Hi. I&#39;m NanXu. Atom Feed"><link rel="stylesheet" href="/assets/css/styles.75da5877.css">
<link rel="preload" href="/assets/js/runtime~main.f004f9dc.js" as="script">
<link rel="preload" href="/assets/js/main.7f227c40.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Developer</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">doc</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/后端">后端</a><button aria-label="Toggle the collapsible sidebar category &#x27;后端&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/前端/ViteJs">前端</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/年终&amp;未来/2022">年终&amp;未来</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/模板/技术设计模板">模板</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/模板/技术设计模板">技术设计模板</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">模板</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">技术设计模板</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>技术设计模板</h1></header><p>大家好，我是老三，转眼间，团队的技术专家B哥，已经离职一年了，我还时不时会想起他，因为他留下的j技术设计模版，我觉得真的很好用，基本上涵盖了设计需要考虑的方方面面。接下来，以一个CRM项目的用户触达模块为例，给大家分享一下。</p><h1>一、CRM<!-- -->_<!-- -->技术设计文档<!-- -->_<!-- -->消息触达模块</h1><p>项目名称    CRM系统<br>
<!-- -->项目负责人    三分恶<br>
<!-- -->模块名称    用户触达模块
模块负责人    三分恶</p><blockquote><p>老三说：第一部分主要说明项目或者模块的概况，这一部分虽然不太重要，但是是必须的。</p></blockquote><h1>二、修订记录</h1><p>版本
修订人</p><p>修订内容</p><p>修订日期</p><p>V1.0</p><p>三分恶</p><p>创建</p><p>2022-12-23</p><blockquote><p>老三说：技术设计不是一成不变的，经常会随着业务的变化，或者根据遇到的一些问题，进行完善和优化，但是每一个版本，都应该留下记录和备份。</p></blockquote><h1>三、需求/背景</h1><p>产品文档：xxxx</p><p>为了实现用户的精细化运营，通过多种途径，向用户发送消息通知……</p><blockquote><p>老三说：这一部分就是结合产品文档，把需求/背景简单提炼一下，必须，但不是重点。</p></blockquote><h1>四、设计目标</h1><blockquote><p>老三说：设计目标一般分为两部分：</p><ul><li>实现功能：这一部分就是就是分析需求，把产品文档里的东西，拆解成一个个的功能，也就是CRUD。</li><li>设计指标：CRUD也有区别，一把梭，随便写也能实现功能，但是我们CRUD也得有点追求，而且面向C端用户的系统，也基本上会有一些性能、可用性之类的要求，比如接口响应平均多少多少毫秒以下、单机QPS1000、系统几个9可用……</li></ul></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="41实现功能">4.1.实现功能<a href="#41实现功能" class="hash-link" aria-label="Direct link to 4.1.实现功能" title="Direct link to 4.1.实现功能">​</a></h2><ol><li>多种渠道给用户推送消息，主要包含站内和站外两大部分：</li></ol><ul><li>站内：<ul><li>站内信</li><li>弹屏</li></ul></li><li>站外：<ul><li>邮件</li><li>短信</li><li>push</li><li>微信</li><li>……</li></ul></li></ul><ol start="2"><li>触达任务管理</li></ol><ul><li>支持定时/延时消息发送</li><li>支持触发型消息发送</li><li>支持用户分群发送</li></ul><p>……</p><blockquote><p>老三说：功能点比较多的话，这一部分还可以用思维导图的形式来整理。</p></blockquote><p><img loading="lazy" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5f2bd977664947628926e8ebba9867c1~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="思维导图" class="img_ev3q"></p><blockquote><p>老三说：这一部分评审的时候一定要拉上产品经理或者相关的业务方，确定功能点没有错漏。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="42设计指标">4.2.设计指标<a href="#42设计指标" class="hash-link" aria-label="Direct link to 4.2.设计指标" title="Direct link to 4.2.设计指标">​</a></h2><ol><li>性能要求</li></ol><ul><li>百万级消息分钟级发送完成</li><li>xx接口，性能指标：单机1000并发，95%响应&lt;=200ms</li></ul><p>……</p><blockquote><p>老三说：一般C端的服务都是有比较严格的性能要求的，毕竟如果系统响应慢的话，用户的流失率就会变高。当然，用户触达，其实主要在于推，用户主动查会少一些，消息的推送通常也会要求速度，比如，有个网红，九点钟要在app上直播，直播开始的时候，要做一个推送，那就要求尽可能快地把消息推送给每个用户，不能说等到十二点直播完了，有的用户才收到消息。</p></blockquote><ol start="2"><li>可用性</li></ol><ul><li>触达模块99.9%可用</li><li>消息推送成功率80%以上</li></ul><p>……</p><blockquote><p>老三说：C端系统的可用性比较重要，毕竟挂一会，影响的用户可能都是以万计，所以，设计的时候，也要考虑可用性，分析系统的瓶颈在哪里，流量突然上来，哪里可能顶不住，是要扩容，还是要限流、熔断降级……</p></blockquote><ol start="3"><li>扩展性</li></ol><ul><li>采用策略模式+配置，新增消息渠道，只需少量代码+代码即可实现</li><li>引入规则引擎，同一消息类型的不同渠道，可以通过规则调整，无需发版</li></ul><p>……</p><blockquote><p>老三说：这一部分也是设计中应当考虑的，不能一味求快，否则很容易堆屎山。</p></blockquote><ol start="4"><li>兼容性</li></ol><ul><li>接口xxx向前兼容app 1.9.0版本，低版本需强制更新</li></ul><p>……</p><blockquote><p>老三说：C端系统的开发，有时候比较麻的是低版本app的兼容，尽可能早期设计的时候，就考虑可能的扩展，如果实在没法兼容，那就只能app强制更新，当然这种用户体验就非常不好了。</p></blockquote><ol start="5"><li>可观测性</li></ol><ul><li>接入Prometheus和Grafana，对服务和业务进行监控<ul><li>服务监控：通过控制面板观察服务的内存、CPU、JVM、接口QPS、接口RT……</li><li>业务监控：通过埋点上报，收集用户触达数据，通过面板可以分设备、渠道查看用户触达成功率……</li></ul></li></ul><blockquote><p>老三说：这一部分也很重要，我们一般上班的第一件事，就是看监控面板，分析有没有什么异常的地方。服务的可观测性，一般公司都是用一些开源的或者付费的监控平台，大厂一般都会自研监控平台。服务的监控很多是通过插桩来实现，业务的监控一般都需要打埋点。</p></blockquote><ol start="6"><li>告警</li></ol><ul><li>通过PrometheusAlert实现服务的告警，告警信息分级别，进行飞书通知、电话通知，告警类型分为服务告警和业务告警<ul><li>服务告警：内存、CPU占用过高，接口QPS过多，接口RT过长，触发告警</li><li>业务告警：用户触达成功率过低告警</li></ul></li></ul><blockquote><p>老三说：告警通常也是和监控在一起的，毕竟开发人员也不可能二十四小时盯着告警，一般开源的、付费的、自建的监控系统，都支持配置告警规则，并通过不同的方式，邮件、短信、电话之类的渠道进行通知。</p></blockquote><h1>五、概要设计</h1><blockquote><p>老三说：概要设计，就是做个大概的系统整体设计。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="51设计思路">5.1.设计思路<a href="#51设计思路" class="hash-link" aria-label="Direct link to 5.1.设计思路" title="Direct link to 5.1.设计思路">​</a></h2><ul><li>数百万消息段时间发送完成，流量较大，对数据存储性能要求较高，需要选用高性能DB，对存储压力也比较大，同时需要一定削峰处理</li><li>定时/延时消息发送采用消息队列实现，对MQ的消费要求较高，并发度要高，批量消费</li><li>……</li></ul><blockquote><p>老三说：这一部分主要是梳理一下整体的开发设计思路，把一些零散的想法梳理成点或者面，前期大家的讨论可以整理在这里。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="52技术选型">5.2.技术选型<a href="#52技术选型" class="hash-link" aria-label="Direct link to 5.2.技术选型" title="Direct link to 5.2.技术选型">​</a></h2><ul><li>存储：TiDB</li><li>缓存：Redis</li><li>消息队列：业务RocketMQ，埋点Kafka</li><li>注册中心：Nacos</li><li>配置中心：Nacos</li><li>RPC：Dubbo</li><li>网关：Gateway</li><li>Push通道：自建</li></ul><p>……</p><blockquote><p>老三说：这一部分就是大概定一下技术选型，其实要是整个项目做好了选型，这一部分也可以不做，一般需要高级技术人员或者架构师，来整体地进行把握，当然，很多时候选型也没好选的，基本就是主流的那些，而且一般一个团队，都是统一的技术选型，方便维护。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="53业务架构">5.3.业务架构<a href="#53业务架构" class="hash-link" aria-label="Direct link to 5.3.业务架构" title="Direct link to 5.3.业务架构">​</a></h2><p><img loading="lazy" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e4e12887f85744b6bf13b05cd7ff993e~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="业务架构" class="img_ev3q"></p><blockquote><p>老三说：这一部分就是大概对功能分分层，分分块，把大概的功能切一切。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="54技术架构">5.4.技术架构<a href="#54技术架构" class="hash-link" aria-label="Direct link to 5.4.技术架构" title="Direct link to 5.4.技术架构">​</a></h2><blockquote><p>老三说：技术选型+业务架构，其实一个大概的技术架构就出来了。</p></blockquote><p><img loading="lazy" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ebb45efcaaba4f9898d979e8efc0c1c7~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="技术架构" class="img_ev3q"></p><blockquote><p>老三说：技术架构图类型，其实也没有特别固定的形式，主要是图能达意，我这个图是通过draw.io画的，还有一些其它的还用的工具，比如大家应该都听过“PPT架构师”，用PPT画也是可以的。当然这个图是我随手画的。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="55系统环境">5.5.系统环境<a href="#55系统环境" class="hash-link" aria-label="Direct link to 5.5.系统环境" title="Direct link to 5.5.系统环境">​</a></h2><ul><li>JDK版本：11</li><li>部署环境：k8s+Containerd，单pod8核CPU+4G内存，服务集群32个pod</li><li>数据库：<ul><li>业务数据：TiDB 64核CPU+128G内存</li><li>离线数据：Hbase……</li></ul></li><li>……</li></ul><blockquote><p>老三说：如果是项目初建，一般还需要对系统的环境进行评估，根据技术选型、数据容量、系统QPS等等，来选择系统的环境，这一部分一般评审的时候会拉上运维同学，提前确定好系统环境，和运维同学对齐需求和排期。</p></blockquote><h1>六、详细设计</h1><blockquote><p>老三说：详细设计，就是具体指导开发的设计部分了，包括流程啊、数据模型啊、具体用到的算法、和客户端的接口，等等，这一部分很重要，如果没做好，没对齐，那么搞不好就要返工，耽误进度。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="61流程设计">6.1.流程设计<a href="#61流程设计" class="hash-link" aria-label="Direct link to 6.1.流程设计" title="Direct link to 6.1.流程设计">​</a></h2><ul><li>push流程</li></ul><p><img loading="lazy" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cea7140e1914431bb021b050dc60f27a~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="push流程" class="img_ev3q"></p><blockquote><p>老三说：用户触达，业务流程基本比较简单，对于一些交易类的，比如支付，或者B端的系统，比如ERP，在开始开发之前，流程一定要梳理清楚，一般通过流程图、时序图来描述业务流程。给大家看一下我之前对接alipay画的简单的时序图：</p><p><img loading="lazy" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e6368d64b5c447ac825c64798584fc0a~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="Alipay接入时序图" class="img_ev3q"></p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="62算法设计">6.2.算法设计<a href="#62算法设计" class="hash-link" aria-label="Direct link to 6.2.算法设计" title="Direct link to 6.2.算法设计">​</a></h2><ul><li>渠道分流：同一消息类型，多种渠道，支持按比例分流，采用加权随机算法实现</li><li>……</li></ul><blockquote><p>老三说：算法设置不一定数据结构相关的算法，代码里的一些涉及到一些需要进行逻辑计算的，都可以称之为算法，这一部分也可以先梳理一下。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="63数据模型设计">6.3.数据模型设计<a href="#63数据模型设计" class="hash-link" aria-label="Direct link to 6.3.数据模型设计" title="Direct link to 6.3.数据模型设计">​</a></h2><ul><li>crm<!-- -->_<!-- -->user<!-- -->_<!-- -->toutch<!-- -->_<!-- -->tash：用户触达任务表</li></ul><p>字段</p><p>描述</p><p>数据类型</p><p>id</p><p>主键</p><p>bigint</p><p>task<!-- -->_<!-- -->no</p><p>任务编号</p><p>bigint</p><p>comment</p><p>描述</p><p>varchar</p><p>……</p><blockquote><p>老三说：数据模型设计非常重要，可以说是系统设计的根基，如果没有设计好，开发和维护起来真的很痛苦，每个公司应该都有一定的数据库设计规范，基本就是结合业务和规范来设计了。</p><p>具体用什么工具设计呢？业务比较简单的C端系统，其实直接拿表格也行，之前也试过PdMan，还行吧。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="64接口设计">6.4.接口设计<a href="#64接口设计" class="hash-link" aria-label="Direct link to 6.4.接口设计" title="Direct link to 6.4.接口设计">​</a></h2><p>接口名称</p><p>添加支付任务</p><p>接口文档地址</p><p><a href="https://link.juejin.cn?target=https%3A%2F%2Fyapi.com%2Fxxx" target="_blank" rel="noopener noreferrer" title="https://yapi.com/xxx">yapi.com/xxx</a></p><p>入参</p><p>入参描述</p><p>comment：任务描述</p><p>出参</p><p>出参描</p><blockquote><p>老三说：这一部分也是重量级，但凡涉及到客户端，或者其它服务的，这一部分都少不了，一般可以通过YApai之类的接口工具，但是建议大家还是在文档里做个重复工作，把入参出参之类的描述一下，有些地方标标重点，因为有些人真的不怎么会看文档。</p><p>接口设计的时候一定要和相关的同学对齐，不要怕花时间，后期改接口，是一件很痛苦的事情。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="65异常处理">6.5.异常处理<a href="#65异常处理" class="hash-link" aria-label="Direct link to 6.5.异常处理" title="Direct link to 6.5.异常处理">​</a></h2><ul><li>系统中的不确定异常，进行统一处理，响应“Network Error”</li><li>埋点异步发送，不影响主要功能</li><li>……</li></ul><blockquote><p>老三说：异常处理也是需要考虑的地方，哪些异常可以吞掉降级，哪些没法处理，怎么给客户端展示，怎么打日志，都需要考虑。</p></blockquote><h1>七、风险评估</h1><blockquote><p>老三说：其实每一次上线都伴随着风险，从设计，一直到上线之前，都要对存在的风险进行评估，上线了要重点观察风险点，也要提前设计好回滚或者处理方案，一旦发现不对劲，及时回滚和处理。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="71已知风险">7.1.已知风险<a href="#71已知风险" class="hash-link" aria-label="Direct link to 7.1.已知风险" title="Direct link to 7.1.已知风险">​</a></h2><ul><li>对数据相关服务压力较大，用户分群、用户画像等数据服务崩溃风险</li><li>MQ存在堆积风险，导致用户收到消息延迟</li><li>QPS较高，数据库CPU飙升风险</li><li>……</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="72可能风险">7.2.可能风险<a href="#72可能风险" class="hash-link" aria-label="Direct link to 7.2.可能风险" title="Direct link to 7.2.可能风险">​</a></h2><ul><li>场景类消息延迟，可能会影响交易相关流程，拉低转化率和成交率</li></ul><p>……</p><h1>八、测试建议</h1><blockquote><p>老三说：需求评审阶段、设计评审阶段，最好都拉上测试同学，测试同学要对整体的功能，还有性能，都有比较清楚的了解。但是啊，如果只看功能的话，可能就是表面的点点点，具体实现逻辑，还是开发比较清楚，所以说给测试同学提一些测试建议，给测试的测试用例提供参考。</p><p>同时，我个人觉得，从测试的角度进行思考，也能有效减少写代码的bug。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="81功能测试">8.1.功能测试<a href="#81功能测试" class="hash-link" aria-label="Direct link to 8.1.功能测试" title="Direct link to 8.1.功能测试">​</a></h2><p>功能</p><p>测试步骤</p><p>预期结果</p><p>定时消息发送</p><p>创建定时消息</p><p>消息定时发送</p><p>……</p><blockquote><p>老三说：这一部分基本就是结合设计目标的实现功能，列一下测试步骤和预期结果</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="82性能测试">8.2.性能测试<a href="#82性能测试" class="hash-link" aria-label="Direct link to 8.2.性能测试" title="Direct link to 8.2.性能测试">​</a></h2><ul><li>xxx接口压测，预估单机QPS1000</li></ul><blockquote><p>这一部分基本就是压测了，很多时候，系统的压测没那么简单，尤其是链路长的时候，压一次都得兴师动众。</p></blockquote><h1>九、上线准备</h1><ul><li>运维搭建环境</li><li>数据初始化</li><li>添加配置</li><li>消息队列创建</li><li>依赖服务上线</li><li>服务上线</li></ul><blockquote><p>老三说：这一部分算是上线的备忘吧，有些wiki类的工具，支持在文档里建任务，把上线前需要做的事情列出来，有不知道你经历过“测试环境猛如虎，上线一看原地杵”没？可能就是上线准备没做好，缺了什么，少了什么。</p></blockquote><h1>十、评审及意见</h1><p>评审意见</p><p>提出人</p><p>提出日期</p><p>解决意见</p><p>解决人</p><p>解决日期</p><p>xxx接口需要考虑一下兼容性，建议xx字段，从object改为list</p><p>老六</p><p>2023年1月1日</p><p>修改字段类型</p><p>老三</p><p>2023年1月1日</p><p>……</p><blockquote><p>老三说：设计文档不是写完，啪，丢出去就完事了，还要上设计评审会，评审的时候，通常相关同学会提出一些评审意见，这些都应该记录下来，解决完了之后，再次评审，直到评审通过，然后就可以开始CRUD了。</p></blockquote><hr><p>好了，看完这个模板，想必你对技术设计也有一定的认识了，老三实际上没怎么接触过用户运营相关的东西，所以内容大家随便看看，主要看模板。</p><p>当然模板是相对固定的，但是设计是灵活的，做技术设计的时候，也不用拘泥于固定的形式，根据具体的需求，考虑到需要考虑的点，能做到设计指导开发就够了。</p><p>那么，假如你已经能做好技术设计……</p><p>但是——</p><p>老板：三某，这个需求，三天能不能搞定？</p><p>老三：可能不太……</p><p>老板：这个需求很急，而且我不能不急，你懂我的意思吧？</p><p>老三：没问题，三天够了！</p><p>而且——</p><p>老板：呦，三某的文档写的很清晰，代码也很优雅，今年公司绩效不好，找个实习生把他替了吧。</p><p>……</p><p><img loading="lazy" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f78679db19aa4176a2d3d65524431338~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp" alt="绷不住" class="img_ev3q"></p><hr><p><strong>参考：</strong></p><p>[<!-- -->1<!-- -->]<!-- -->.用户运营：触达系统应该如何搭建:<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.woshipm.com%2Fuser-research%2F4239618.html" target="_blank" rel="noopener noreferrer" title="https://www.woshipm.com/user-research/4239618.html">www.woshipm.com/user-resear…</a>)</p><p>[<!-- -->2<!-- -->]<!-- -->.一个实时精准触达系统的自我修养:<a href="https://juejin.cn/post/6844904009770221581" target="_blank" rel="noopener noreferrer" title="https://juejin.cn/post/6844904009770221581">juejin.cn/post/684490…</a></p><hr></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/年终&amp;未来/2022"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">概述</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#41实现功能" class="table-of-contents__link toc-highlight">4.1.实现功能</a></li><li><a href="#42设计指标" class="table-of-contents__link toc-highlight">4.2.设计指标</a></li><li><a href="#51设计思路" class="table-of-contents__link toc-highlight">5.1.设计思路</a></li><li><a href="#52技术选型" class="table-of-contents__link toc-highlight">5.2.技术选型</a></li><li><a href="#53业务架构" class="table-of-contents__link toc-highlight">5.3.业务架构</a></li><li><a href="#54技术架构" class="table-of-contents__link toc-highlight">5.4.技术架构</a></li><li><a href="#55系统环境" class="table-of-contents__link toc-highlight">5.5.系统环境</a></li><li><a href="#61流程设计" class="table-of-contents__link toc-highlight">6.1.流程设计</a></li><li><a href="#62算法设计" class="table-of-contents__link toc-highlight">6.2.算法设计</a></li><li><a href="#63数据模型设计" class="table-of-contents__link toc-highlight">6.3.数据模型设计</a></li><li><a href="#64接口设计" class="table-of-contents__link toc-highlight">6.4.接口设计</a></li><li><a href="#65异常处理" class="table-of-contents__link toc-highlight">6.5.异常处理</a></li><li><a href="#71已知风险" class="table-of-contents__link toc-highlight">7.1.已知风险</a></li><li><a href="#72可能风险" class="table-of-contents__link toc-highlight">7.2.可能风险</a></li><li><a href="#81功能测试" class="table-of-contents__link toc-highlight">8.1.功能测试</a></li><li><a href="#82性能测试" class="table-of-contents__link toc-highlight">8.2.性能测试</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.f004f9dc.js"></script>
<script src="/assets/js/main.7f227c40.js"></script>
</body>
</html>