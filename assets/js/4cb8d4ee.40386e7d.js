"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[508],{3905:(e,n,r)=>{r.d(n,{Zo:()=>u,kt:()=>g});var t=r(7294);function a(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){a(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function l(e,n){if(null==e)return{};var r,t,a=function(e,n){if(null==e)return{};var r,t,a={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||(a[r]=e[r]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var i=t.createContext({}),c=function(e){var n=t.useContext(i),r=n;return e&&(r="function"==typeof e?e(n):s(s({},n),e)),r},u=function(e){var n=c(e.components);return t.createElement(i.Provider,{value:n},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},p=t.forwardRef((function(e,n){var r=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=c(r),p=a,g=m["".concat(i,".").concat(p)]||m[p]||d[p]||o;return r?t.createElement(g,s(s({ref:n},u),{},{components:r})):t.createElement(g,s({ref:n},u))}));function g(e,n){var r=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=r.length,s=new Array(o);s[0]=p;var l={};for(var i in n)hasOwnProperty.call(n,i)&&(l[i]=n[i]);l.originalType=e,l[m]="string"==typeof e?e:a,s[1]=l;for(var c=2;c<o;c++)s[c]=r[c];return t.createElement.apply(null,s)}return t.createElement.apply(null,r)}p.displayName="MDXCreateElement"},2189:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>i,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var t=r(7462),a=(r(7294),r(3905));const o={},s="RocketMQ",l={unversionedId:"\u540e\u7aef/\u4e2d\u95f4\u4ef6/RocketMQ",id:"\u540e\u7aef/\u4e2d\u95f4\u4ef6/RocketMQ",title:"RocketMQ",description:"RocketMQ \u5feb\u901f\u5165\u95e8",source:"@site/docs/\u540e\u7aef/\u4e2d\u95f4\u4ef6/RocketMQ.md",sourceDirName:"\u540e\u7aef/\u4e2d\u95f4\u4ef6",slug:"/\u540e\u7aef/\u4e2d\u95f4\u4ef6/RocketMQ",permalink:"/docs/\u540e\u7aef/\u4e2d\u95f4\u4ef6/RocketMQ",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u5b89\u88c5",permalink:"/docs/\u540e\u7aef/kubernetes/\u5b89\u88c5"},next:{title:"\u5fae\u4fe1\u516c\u4f17\u53f7",permalink:"/docs/\u540e\u7aef/\u5fae\u4fe1\u5f00\u53d1/\u5fae\u4fe1\u516c\u4f17\u53f7"}},i={},c=[{value:"RocketMQ \u5feb\u901f\u5165\u95e8",id:"rocketmq-\u5feb\u901f\u5165\u95e8",level:2},{value:"\u57fa\u672c\u6982\u5ff5",id:"\u57fa\u672c\u6982\u5ff5",level:3},{value:"1\u3001\u6d88\u606f\u6a21\u578b\uff08Message Model\uff09",id:"1\u6d88\u606f\u6a21\u578bmessage-model",level:4},{value:"2\u3001\u6d88\u606f\u751f\u4ea7\u8005\uff08Producer\uff09",id:"2\u6d88\u606f\u751f\u4ea7\u8005producer",level:4},{value:"3\u3001\u6d88\u606f\u6d88\u8d39\u8005\uff08Consumer\uff09",id:"3\u6d88\u606f\u6d88\u8d39\u8005consumer",level:4},{value:"4\u3001\u4e3b\u9898\uff08Topic\uff09",id:"4\u4e3b\u9898topic",level:4},{value:"5\u3001\u4ee3\u7406\u670d\u52a1\u5668\uff08Broker Server\uff09",id:"5\u4ee3\u7406\u670d\u52a1\u5668broker-server",level:4},{value:"6\u3001\u540d\u5b57\u670d\u52a1\uff08Name Server\uff09",id:"6\u540d\u5b57\u670d\u52a1name-server",level:4},{value:"7\u3001\u62c9\u53d6\u5f0f\u6d88\u8d39\uff08Pull Consumer\uff09",id:"7\u62c9\u53d6\u5f0f\u6d88\u8d39pull-consumer",level:4},{value:"8\u3001\u63a8\u52a8\u5f0f\u6d88\u8d39\uff08Push Consumer\uff09",id:"8\u63a8\u52a8\u5f0f\u6d88\u8d39push-consumer",level:4},{value:"9\u3001\u751f\u4ea7\u8005\u7ec4\uff08Producer Group\uff09",id:"9\u751f\u4ea7\u8005\u7ec4producer-group",level:4},{value:"10\u3001\u6d88\u8d39\u8005\u7ec4\uff08Consumer Group\uff09",id:"10\u6d88\u8d39\u8005\u7ec4consumer-group",level:4},{value:"11\u3001\u96c6\u7fa4\u6d88\u8d39\uff08Clustering\uff09",id:"11\u96c6\u7fa4\u6d88\u8d39clustering",level:4},{value:"12\u3001\u5e7f\u64ad\u6d88\u8d39\uff08Broadcasting\uff09",id:"12\u5e7f\u64ad\u6d88\u8d39broadcasting",level:4},{value:"13\u3001\u666e\u901a\u987a\u5e8f\u6d88\u606f\uff08Normal Ordered Message\uff09",id:"13\u666e\u901a\u987a\u5e8f\u6d88\u606fnormal-ordered-message",level:4},{value:"14\u3001\u4e25\u683c\u987a\u5e8f\u6d88\u606f\uff08Strictly Ordered Message\uff09",id:"14\u4e25\u683c\u987a\u5e8f\u6d88\u606fstrictly-ordered-message",level:4},{value:"15\u3001\u6d88\u606f\uff08Message\uff09",id:"15\u6d88\u606fmessage",level:4},{value:"16\u3001\u6807\u7b7e\uff08Tag\uff09",id:"16\u6807\u7b7etag",level:4},{value:"\u6280\u672f\u67b6\u6784",id:"\u6280\u672f\u67b6\u6784",level:3},{value:"\u5b89\u88c5RocketMQ",id:"\u5b89\u88c5rocketmq",level:3},{value:"\u5b89\u88c5 RocketMQ Console (\u53ef\u9009)",id:"\u5b89\u88c5-rocketmq-console-\u53ef\u9009",level:4},{value:"\u9879\u76ee\u642d\u5efa",id:"\u9879\u76ee\u642d\u5efa",level:3},{value:"\u57fa\u672c\u6837\u4f8b",id:"\u57fa\u672c\u6837\u4f8b",level:3},{value:"1\u3001Producer\u7aef\u53d1\u9001\u540c\u6b65\u6d88\u606f",id:"1producer\u7aef\u53d1\u9001\u540c\u6b65\u6d88\u606f",level:4},{value:"2\u3001\u53d1\u9001\u5f02\u6b65\u6d88\u606f",id:"2\u53d1\u9001\u5f02\u6b65\u6d88\u606f",level:4},{value:"3\u3001\u5355\u5411\u53d1\u9001\u6d88\u606f",id:"3\u5355\u5411\u53d1\u9001\u6d88\u606f",level:4},{value:"4\u3001\u6d88\u8d39\u6d88\u606f",id:"4\u6d88\u8d39\u6d88\u606f",level:4},{value:"RocketMQ \u6279\u91cf\u6d88\u606f",id:"rocketmq-\u6279\u91cf\u6d88\u606f",level:2},{value:"\u6279\u91cf\u6d88\u606f",id:"\u6279\u91cf\u6d88\u606f",level:3},{value:"\u53d1\u9001\u6279\u91cf\u6d88\u606f",id:"\u53d1\u9001\u6279\u91cf\u6d88\u606f",level:3},{value:"\u6d88\u606f\u5217\u8868\u5206\u5272",id:"\u6d88\u606f\u5217\u8868\u5206\u5272",level:3},{value:"\u53d1\u9001\u5206\u5272\u540e\u6279\u91cf\u6d88\u606f",id:"\u53d1\u9001\u5206\u5272\u540e\u6279\u91cf\u6d88\u606f",level:3},{value:"\u6279\u91cf\u6d88\u606f\u6d88\u8d39",id:"\u6279\u91cf\u6d88\u606f\u6d88\u8d39",level:3},{value:"RocketMQ \u987a\u5e8f\u6d88\u606f",id:"rocketmq-\u987a\u5e8f\u6d88\u606f",level:2},{value:"\u987a\u5e8f\u6d88\u606f",id:"\u987a\u5e8f\u6d88\u606f",level:3},{value:"\u987a\u5e8f\u6d88\u606f\u751f\u4ea7",id:"\u987a\u5e8f\u6d88\u606f\u751f\u4ea7",level:3},{value:"\u987a\u5e8f\u6d88\u8d39\u6d88\u606f",id:"\u987a\u5e8f\u6d88\u8d39\u6d88\u606f",level:3},{value:"RocketMQ \u5b9a\u65f6\u6d88\u606f",id:"rocketmq-\u5b9a\u65f6\u6d88\u606f",level:2},{value:"\u5b9a\u65f6\u6d88\u606f",id:"\u5b9a\u65f6\u6d88\u606f",level:3},{value:"\u542f\u52a8\u6d88\u8d39\u8005\u7b49\u5f85\u4f20\u5165\u8ba2\u9605\u6d88\u606f",id:"\u542f\u52a8\u6d88\u8d39\u8005\u7b49\u5f85\u4f20\u5165\u8ba2\u9605\u6d88\u606f",level:3},{value:"\u53d1\u9001\u5ef6\u65f6\u6d88\u606f",id:"\u53d1\u9001\u5ef6\u65f6\u6d88\u606f",level:3},{value:"RocketMQ \u4e8b\u52a1\u6d88\u606f",id:"rocketmq-\u4e8b\u52a1\u6d88\u606f",level:2},{value:"\u4e8b\u52a1\u6d88\u606f",id:"\u4e8b\u52a1\u6d88\u606f",level:3},{value:"\u53d1\u9001\u4e8b\u52a1\u6d88\u606f",id:"\u53d1\u9001\u4e8b\u52a1\u6d88\u606f",level:4}],u={toc:c},m="wrapper";function d(e){let{components:n,...r}=e;return(0,a.kt)(m,(0,t.Z)({},u,r,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"rocketmq"},"RocketMQ"),(0,a.kt)("h2",{id:"rocketmq-\u5feb\u901f\u5165\u95e8"},"RocketMQ \u5feb\u901f\u5165\u95e8"),(0,a.kt)("h3",{id:"\u57fa\u672c\u6982\u5ff5"},"\u57fa\u672c\u6982\u5ff5"),(0,a.kt)("h4",{id:"1\u6d88\u606f\u6a21\u578bmessage-model"},"1\u3001\u6d88\u606f\u6a21\u578b\uff08Message Model\uff09"),(0,a.kt)("p",null,"RocketMQ\u4e3b\u8981\u7531 Producer\u3001Broker\u3001Consumer \u4e09\u90e8\u5206\u7ec4\u6210\uff0c\u5176\u4e2dProducer \u8d1f\u8d23\u751f\u4ea7\u6d88\u606f\uff0cConsumer \u8d1f\u8d23\u6d88\u8d39\u6d88\u606f\uff0cBroker \u8d1f\u8d23\u5b58\u50a8\u6d88\u606f\u3002Broker \u5728\u5b9e\u9645\u90e8\u7f72\u8fc7\u7a0b\u4e2d\u5bf9\u5e94\u4e00\u53f0\u670d\u52a1\u5668\uff0c\u6bcf\u4e2a Broker \u53ef\u4ee5\u5b58\u50a8\u591a\u4e2aTopic\u7684\u6d88\u606f\uff0c\u6bcf\u4e2aTopic\u7684\u6d88\u606f\u4e5f\u53ef\u4ee5\u5206\u7247\u5b58\u50a8\u4e8e\u4e0d\u540c\u7684 Broker\u3002Message Queue \u7528\u4e8e\u5b58\u50a8\u6d88\u606f\u7684\u7269\u7406\u5730\u5740\uff0c\u6bcf\u4e2aTopic\u4e2d\u7684\u6d88\u606f\u5730\u5740\u5b58\u50a8\u4e8e\u591a\u4e2a Message Queue \u4e2d\u3002ConsumerGroup \u7531\u591a\u4e2aConsumer \u5b9e\u4f8b\u6784\u6210\u3002"),(0,a.kt)("h4",{id:"2\u6d88\u606f\u751f\u4ea7\u8005producer"},"2\u3001\u6d88\u606f\u751f\u4ea7\u8005\uff08Producer\uff09"),(0,a.kt)("p",null,"\u8d1f\u8d23\u751f\u4ea7\u6d88\u606f\uff0c\u4e00\u822c\u7531\u4e1a\u52a1\u7cfb\u7edf\u8d1f\u8d23\u751f\u4ea7\u6d88\u606f\u3002\u4e00\u4e2a\u6d88\u606f\u751f\u4ea7\u8005\u4f1a\u628a\u4e1a\u52a1\u5e94\u7528\u7cfb\u7edf\u91cc\u4ea7\u751f\u7684\u6d88\u606f\u53d1\u9001\u5230broker\u670d\u52a1\u5668\u3002RocketMQ\u63d0\u4f9b\u591a\u79cd\u53d1\u9001\u65b9\u5f0f\uff0c\u540c\u6b65\u53d1\u9001\u3001\u5f02\u6b65\u53d1\u9001\u3001\u987a\u5e8f\u53d1\u9001\u3001\u5355\u5411\u53d1\u9001\u3002\u540c\u6b65\u548c\u5f02\u6b65\u65b9\u5f0f\u5747\u9700\u8981Broker\u8fd4\u56de\u786e\u8ba4\u4fe1\u606f\uff0c\u5355\u5411\u53d1\u9001\u4e0d\u9700\u8981\u3002"),(0,a.kt)("h4",{id:"3\u6d88\u606f\u6d88\u8d39\u8005consumer"},"3\u3001\u6d88\u606f\u6d88\u8d39\u8005\uff08Consumer\uff09"),(0,a.kt)("p",null,"\u8d1f\u8d23\u6d88\u8d39\u6d88\u606f\uff0c\u4e00\u822c\u662f\u540e\u53f0\u7cfb\u7edf\u8d1f\u8d23\u5f02\u6b65\u6d88\u8d39\u3002\u4e00\u4e2a\u6d88\u606f\u6d88\u8d39\u8005\u4f1a\u4eceBroker\u670d\u52a1\u5668\u62c9\u53d6\u6d88\u606f\u3001\u5e76\u5c06\u5176\u63d0\u4f9b\u7ed9\u5e94\u7528\u7a0b\u5e8f\u3002\u4ece\u7528\u6237\u5e94\u7528\u7684\u89d2\u5ea6\u800c\u8a00\u63d0\u4f9b\u4e86\u4e24\u79cd\u6d88\u8d39\u5f62\u5f0f\uff1a\u62c9\u53d6\u5f0f\u6d88\u8d39\u3001\u63a8\u52a8\u5f0f\u6d88\u8d39\u3002"),(0,a.kt)("h4",{id:"4\u4e3b\u9898topic"},"4\u3001\u4e3b\u9898\uff08Topic\uff09"),(0,a.kt)("p",null,"\u8868\u793a\u4e00\u7c7b\u6d88\u606f\u7684\u96c6\u5408\uff0c\u6bcf\u4e2a\u4e3b\u9898\u5305\u542b\u82e5\u5e72\u6761\u6d88\u606f\uff0c\u6bcf\u6761\u6d88\u606f\u53ea\u80fd\u5c5e\u4e8e\u4e00\u4e2a\u4e3b\u9898\uff0c\u662fRocketMQ\u8fdb\u884c\u6d88\u606f\u8ba2\u9605\u7684\u57fa\u672c\u5355\u4f4d\u3002"),(0,a.kt)("h4",{id:"5\u4ee3\u7406\u670d\u52a1\u5668broker-server"},"5\u3001\u4ee3\u7406\u670d\u52a1\u5668\uff08Broker Server\uff09"),(0,a.kt)("p",null,"\u6d88\u606f\u4e2d\u8f6c\u89d2\u8272\uff0c\u8d1f\u8d23\u5b58\u50a8\u6d88\u606f\u3001\u8f6c\u53d1\u6d88\u606f\u3002\u4ee3\u7406\u670d\u52a1\u5668\u5728RocketMQ\u7cfb\u7edf\u4e2d\u8d1f\u8d23\u63a5\u6536\u4ece\u751f\u4ea7\u8005\u53d1\u9001\u6765\u7684\u6d88\u606f\u5e76\u5b58\u50a8\u3001\u540c\u65f6\u4e3a\u6d88\u8d39\u8005\u7684\u62c9\u53d6\u8bf7\u6c42\u4f5c\u51c6\u5907\u3002\u4ee3\u7406\u670d\u52a1\u5668\u4e5f\u5b58\u50a8\u6d88\u606f\u76f8\u5173\u7684\u5143\u6570\u636e\uff0c\u5305\u62ec\u6d88\u8d39\u8005\u7ec4\u3001\u6d88\u8d39\u8fdb\u5ea6\u504f\u79fb\u548c\u4e3b\u9898\u548c\u961f\u5217\u6d88\u606f\u7b49\u3002"),(0,a.kt)("h4",{id:"6\u540d\u5b57\u670d\u52a1name-server"},"6\u3001\u540d\u5b57\u670d\u52a1\uff08Name Server\uff09"),(0,a.kt)("p",null,"\u540d\u79f0\u670d\u52a1\u5145\u5f53\u8def\u7531\u6d88\u606f\u7684\u63d0\u4f9b\u8005\u3002\u751f\u4ea7\u8005\u6216\u6d88\u8d39\u8005\u80fd\u591f\u901a\u8fc7\u540d\u5b57\u670d\u52a1\u67e5\u627e\u5404\u4e3b\u9898\u76f8\u5e94\u7684Broker IP\u5217\u8868\u3002\u591a\u4e2aNamesrv\u5b9e\u4f8b\u7ec4\u6210\u96c6\u7fa4\uff0c\u4f46\u76f8\u4e92\u72ec\u7acb\uff0c\u6ca1\u6709\u4fe1\u606f\u4ea4\u6362\u3002"),(0,a.kt)("h4",{id:"7\u62c9\u53d6\u5f0f\u6d88\u8d39pull-consumer"},"7\u3001\u62c9\u53d6\u5f0f\u6d88\u8d39\uff08Pull Consumer\uff09"),(0,a.kt)("p",null,"Consumer\u6d88\u8d39\u7684\u4e00\u79cd\u7c7b\u578b\uff0c\u5e94\u7528\u901a\u5e38\u4e3b\u52a8\u8c03\u7528Consumer\u7684\u62c9\u6d88\u606f\u65b9\u6cd5\u4eceBroker\u670d\u52a1\u5668\u62c9\u6d88\u606f\u3001\u4e3b\u52a8\u6743\u7531\u5e94\u7528\u63a7\u5236\u3002\u4e00\u65e6\u83b7\u53d6\u4e86\u6279\u91cf\u6d88\u606f\uff0c\u5e94\u7528\u5c31\u4f1a\u542f\u52a8\u6d88\u8d39\u8fc7\u7a0b\u3002"),(0,a.kt)("h4",{id:"8\u63a8\u52a8\u5f0f\u6d88\u8d39push-consumer"},"8\u3001\u63a8\u52a8\u5f0f\u6d88\u8d39\uff08Push Consumer\uff09"),(0,a.kt)("p",null,"Consumer\u6d88\u8d39\u7684\u4e00\u79cd\u7c7b\u578b\uff0c\u8be5\u6a21\u5f0f\u4e0bBroker\u6536\u5230\u6570\u636e\u540e\u4f1a\u4e3b\u52a8\u63a8\u9001\u7ed9\u6d88\u8d39\u7aef\uff0c\u8be5\u6d88\u8d39\u6a21\u5f0f\u4e00\u822c\u5b9e\u65f6\u6027\u8f83\u9ad8\u3002"),(0,a.kt)("h4",{id:"9\u751f\u4ea7\u8005\u7ec4producer-group"},"9\u3001\u751f\u4ea7\u8005\u7ec4\uff08Producer Group\uff09"),(0,a.kt)("p",null,"\u540c\u4e00\u7c7bProducer\u7684\u96c6\u5408\uff0c\u8fd9\u7c7bProducer\u53d1\u9001\u540c\u4e00\u7c7b\u6d88\u606f\u4e14\u53d1\u9001\u903b\u8f91\u4e00\u81f4\u3002\u5982\u679c\u53d1\u9001\u7684\u662f\u4e8b\u52a1\u6d88\u606f\u4e14\u539f\u59cb\u751f\u4ea7\u8005\u5728\u53d1\u9001\u4e4b\u540e\u5d29\u6e83\uff0c\u5219Broker\u670d\u52a1\u5668\u4f1a\u8054\u7cfb\u540c\u4e00\u751f\u4ea7\u8005\u7ec4\u7684\u5176\u4ed6\u751f\u4ea7\u8005\u5b9e\u4f8b\u4ee5\u63d0\u4ea4\u6216\u56de\u6eaf\u6d88\u8d39\u3002"),(0,a.kt)("h4",{id:"10\u6d88\u8d39\u8005\u7ec4consumer-group"},"10\u3001\u6d88\u8d39\u8005\u7ec4\uff08Consumer Group\uff09"),(0,a.kt)("p",null,"\u540c\u4e00\u7c7bConsumer\u7684\u96c6\u5408\uff0c\u8fd9\u7c7bConsumer\u901a\u5e38\u6d88\u8d39\u540c\u4e00\u7c7b\u6d88\u606f\u4e14\u6d88\u8d39\u903b\u8f91\u4e00\u81f4\u3002\u6d88\u8d39\u8005\u7ec4\u4f7f\u5f97\u5728\u6d88\u606f\u6d88\u8d39\u65b9\u9762\uff0c\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u548c\u5bb9\u9519\u7684\u76ee\u6807\u53d8\u5f97\u975e\u5e38\u5bb9\u6613\u3002\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6d88\u8d39\u8005\u7ec4\u7684\u6d88\u8d39\u8005\u5b9e\u4f8b\u5fc5\u987b\u8ba2\u9605\u5b8c\u5168\u76f8\u540c\u7684Topic\u3002RocketMQ \u652f\u6301\u4e24\u79cd\u6d88\u606f\u6a21\u5f0f\uff1a\u96c6\u7fa4\u6d88\u8d39\uff08Clustering\uff09\u548c\u5e7f\u64ad\u6d88\u8d39\uff08Broadcasting\uff09\u3002"),(0,a.kt)("h4",{id:"11\u96c6\u7fa4\u6d88\u8d39clustering"},"11\u3001\u96c6\u7fa4\u6d88\u8d39\uff08Clustering\uff09"),(0,a.kt)("p",null,"\u96c6\u7fa4\u6d88\u8d39\u6a21\u5f0f\u4e0b,\u76f8\u540cConsumer Group\u7684\u6bcf\u4e2aConsumer\u5b9e\u4f8b\u5e73\u5747\u5206\u644a\u6d88\u606f\u3002"),(0,a.kt)("h4",{id:"12\u5e7f\u64ad\u6d88\u8d39broadcasting"},"12\u3001\u5e7f\u64ad\u6d88\u8d39\uff08Broadcasting\uff09"),(0,a.kt)("p",null,"\u5e7f\u64ad\u6d88\u8d39\u6a21\u5f0f\u4e0b\uff0c\u76f8\u540cConsumer Group\u7684\u6bcf\u4e2aConsumer\u5b9e\u4f8b\u90fd\u63a5\u6536\u5168\u91cf\u7684\u6d88\u606f\u3002"),(0,a.kt)("h4",{id:"13\u666e\u901a\u987a\u5e8f\u6d88\u606fnormal-ordered-message"},"13\u3001\u666e\u901a\u987a\u5e8f\u6d88\u606f\uff08Normal Ordered Message\uff09"),(0,a.kt)("p",null,"\u666e\u901a\u987a\u5e8f\u6d88\u8d39\u6a21\u5f0f\u4e0b\uff0c\u6d88\u8d39\u8005\u901a\u8fc7\u540c\u4e00\u4e2a\u6d88\u8d39\u961f\u5217\u6536\u5230\u7684\u6d88\u606f\u662f\u6709\u987a\u5e8f\u7684\uff0c\u4e0d\u540c\u6d88\u606f\u961f\u5217\u6536\u5230\u7684\u6d88\u606f\u5219\u53ef\u80fd\u662f\u65e0\u987a\u5e8f\u7684\u3002"),(0,a.kt)("h4",{id:"14\u4e25\u683c\u987a\u5e8f\u6d88\u606fstrictly-ordered-message"},"14\u3001\u4e25\u683c\u987a\u5e8f\u6d88\u606f\uff08Strictly Ordered Message\uff09"),(0,a.kt)("p",null,"\u4e25\u683c\u987a\u5e8f\u6d88\u606f\u6a21\u5f0f\u4e0b\uff0c\u6d88\u8d39\u8005\u6536\u5230\u7684\u6240\u6709\u6d88\u606f\u5747\u662f\u6709\u987a\u5e8f\u7684\u3002"),(0,a.kt)("h4",{id:"15\u6d88\u606fmessage"},"15\u3001\u6d88\u606f\uff08Message\uff09"),(0,a.kt)("p",null,"\u6d88\u606f\u7cfb\u7edf\u6240\u4f20\u8f93\u4fe1\u606f\u7684\u7269\u7406\u8f7d\u4f53\uff0c\u751f\u4ea7\u548c\u6d88\u8d39\u6570\u636e\u7684\u6700\u5c0f\u5355\u4f4d\uff0c\u6bcf\u6761\u6d88\u606f\u5fc5\u987b\u5c5e\u4e8e\u4e00\u4e2a\u4e3b\u9898\u3002RocketMQ\u4e2d\u6bcf\u4e2a\u6d88\u606f\u62e5\u6709\u552f\u4e00\u7684Message ID\uff0c\u4e14\u53ef\u4ee5\u643a\u5e26\u5177\u6709\u4e1a\u52a1\u6807\u8bc6\u7684Key\u3002\u7cfb\u7edf\u63d0\u4f9b\u4e86\u901a\u8fc7Message ID\u548cKey\u67e5\u8be2\u6d88\u606f\u7684\u529f\u80fd\u3002"),(0,a.kt)("h4",{id:"16\u6807\u7b7etag"},"16\u3001\u6807\u7b7e\uff08Tag\uff09"),(0,a.kt)("p",null,"\u4e3a\u6d88\u606f\u8bbe\u7f6e\u7684\u6807\u5fd7\uff0c\u7528\u4e8e\u540c\u4e00\u4e3b\u9898\u4e0b\u533a\u5206\u4e0d\u540c\u7c7b\u578b\u7684\u6d88\u606f\u3002\u6765\u81ea\u540c\u4e00\u4e1a\u52a1\u5355\u5143\u7684\u6d88\u606f\uff0c\u53ef\u4ee5\u6839\u636e\u4e0d\u540c\u4e1a\u52a1\u76ee\u7684\u5728\u540c\u4e00\u4e3b\u9898\u4e0b\u8bbe\u7f6e\u4e0d\u540c\u6807\u7b7e\u3002\u6807\u7b7e\u80fd\u591f\u6709\u6548\u5730\u4fdd\u6301\u4ee3\u7801\u7684\u6e05\u6670\u5ea6\u548c\u8fde\u8d2f\u6027\uff0c\u5e76\u4f18\u5316RocketMQ\u63d0\u4f9b\u7684\u67e5\u8be2\u7cfb\u7edf\u3002\u6d88\u8d39\u8005\u53ef\u4ee5\u6839\u636eTag\u5b9e\u73b0\u5bf9\u4e0d\u540c\u5b50\u4e3b\u9898\u7684\u4e0d\u540c\u6d88\u8d39\u903b\u8f91\uff0c\u5b9e\u73b0\u66f4\u597d\u7684\u6269\u5c55\u6027\u3002"),(0,a.kt)("h3",{id:"\u6280\u672f\u67b6\u6784"},"\u6280\u672f\u67b6\u6784"),(0,a.kt)("p",null,"RocketMQ\u67b6\u6784\u4e0a\u4e3b\u8981\u5206\u4e3a\u56db\u90e8\u5206"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Producer\uff1a\u6d88\u606f\u53d1\u5e03\u7684\u89d2\u8272\uff0c\u652f\u6301\u5206\u5e03\u5f0f\u96c6\u7fa4\u65b9\u5f0f\u90e8\u7f72\u3002Producer\u901a\u8fc7MQ\u7684\u8d1f\u8f7d\u5747\u8861\u6a21\u5757\u9009\u62e9\u76f8\u5e94\u7684Broker\u96c6\u7fa4\u961f\u5217\u8fdb\u884c\u6d88\u606f\u6295\u9012\uff0c\u6295\u9012\u7684\u8fc7\u7a0b\u652f\u6301\u5feb\u901f\u5931\u8d25\u5e76\u4e14\u4f4e\u5ef6\u8fdf\u3002"),(0,a.kt)("li",{parentName:"ul"},"Consumer\uff1a\u6d88\u606f\u6d88\u8d39\u7684\u89d2\u8272\uff0c\u652f\u6301\u5206\u5e03\u5f0f\u96c6\u7fa4\u65b9\u5f0f\u90e8\u7f72\u3002\u652f\u6301\u4ee5push\u63a8\uff0cpull\u62c9\u4e24\u79cd\u6a21\u5f0f\u5bf9\u6d88\u606f\u8fdb\u884c\u6d88\u8d39\u3002\u540c\u65f6\u4e5f\u652f\u6301\u96c6\u7fa4\u65b9\u5f0f\u548c\u5e7f\u64ad\u65b9\u5f0f\u7684\u6d88\u8d39\uff0c\u5b83\u63d0\u4f9b\u5b9e\u65f6\u6d88\u606f\u8ba2\u9605\u673a\u5236\uff0c\u53ef\u4ee5\u6ee1\u8db3\u5927\u591a\u6570\u7528\u6237\u7684\u9700\u6c42\u3002"),(0,a.kt)("li",{parentName:"ul"},"NameServer\uff1aNameServer\u662f\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684Topic\u8def\u7531\u6ce8\u518c\u4e2d\u5fc3\uff0c\u5176\u89d2\u8272\u7c7b\u4f3cDubbo\u4e2d\u7684zookeeper\uff0c\u652f\u6301Broker\u7684\u52a8\u6001\u6ce8\u518c\u4e0e\u53d1\u73b0\u3002\u4e3b\u8981\u5305\u62ec\u4e24\u4e2a\u529f\u80fd\uff1aBroker\u7ba1\u7406\uff0cNameServer\u63a5\u53d7Broker\u96c6\u7fa4\u7684\u6ce8\u518c\u4fe1\u606f\u5e76\u4e14\u4fdd\u5b58\u4e0b\u6765\u4f5c\u4e3a\u8def\u7531\u4fe1\u606f\u7684\u57fa\u672c\u6570\u636e\u3002\u7136\u540e\u63d0\u4f9b\u5fc3\u8df3\u68c0\u6d4b\u673a\u5236\uff0c\u68c0\u67e5Broker\u662f\u5426\u8fd8\u5b58\u6d3b\uff1b\u8def\u7531\u4fe1\u606f\u7ba1\u7406\uff0c\u6bcf\u4e2aNameServer\u5c06\u4fdd\u5b58\u5173\u4e8eBroker\u96c6\u7fa4\u7684\u6574\u4e2a\u8def\u7531\u4fe1\u606f\u548c\u7528\u4e8e\u5ba2\u6237\u7aef\u67e5\u8be2\u7684\u961f\u5217\u4fe1\u606f\u3002\u7136\u540eProducer\u548cConumser\u901a\u8fc7NameServer\u5c31\u53ef\u4ee5\u77e5\u9053\u6574\u4e2aBroker\u96c6\u7fa4\u7684\u8def\u7531\u4fe1\u606f\uff0c\u4ece\u800c\u8fdb\u884c\u6d88\u606f\u7684\u6295\u9012\u548c\u6d88\u8d39\u3002NameServer\u901a\u5e38\u4e5f\u662f\u96c6\u7fa4\u7684\u65b9\u5f0f\u90e8\u7f72\uff0c\u5404\u5b9e\u4f8b\u95f4\u76f8\u4e92\u4e0d\u8fdb\u884c\u4fe1\u606f\u901a\u8baf\u3002Broker\u662f\u5411\u6bcf\u4e00\u53f0NameServer\u6ce8\u518c\u81ea\u5df1\u7684\u8def\u7531\u4fe1\u606f\uff0c\u6240\u4ee5\u6bcf\u4e00\u4e2aNameServer\u5b9e\u4f8b\u4e0a\u9762\u90fd\u4fdd\u5b58\u4e00\u4efd\u5b8c\u6574\u7684\u8def\u7531\u4fe1\u606f\u3002\u5f53\u67d0\u4e2aNameServer\u56e0\u67d0\u79cd\u539f\u56e0\u4e0b\u7ebf\u4e86\uff0cBroker\u4ecd\u7136\u53ef\u4ee5\u5411\u5176\u5b83NameServer\u540c\u6b65\u5176\u8def\u7531\u4fe1\u606f\uff0cProducer,Consumer\u4ecd\u7136\u53ef\u4ee5\u52a8\u6001\u611f\u77e5Broker\u7684\u8def\u7531\u7684\u4fe1\u606f\u3002"),(0,a.kt)("li",{parentName:"ul"},"BrokerServer\uff1aBroker\u4e3b\u8981\u8d1f\u8d23\u6d88\u606f\u7684\u5b58\u50a8\u3001\u6295\u9012\u548c\u67e5\u8be2\u4ee5\u53ca\u670d\u52a1\u9ad8\u53ef\u7528\u4fdd\u8bc1\uff0c\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u4e9b\u529f\u80fd\uff0cBroker\u5305\u542b\u4e86\u4ee5\u4e0b\u51e0\u4e2a\u91cd\u8981\u5b50\u6a21\u5757\u3002",(0,a.kt)("ol",{parentName:"li"},(0,a.kt)("li",{parentName:"ol"},"Remoting Module\uff1a\u6574\u4e2aBroker\u7684\u5b9e\u4f53\uff0c\u8d1f\u8d23\u5904\u7406\u6765\u81eaclients\u7aef\u7684\u8bf7\u6c42\u3002"),(0,a.kt)("li",{parentName:"ol"},"Client Manager\uff1a\u8d1f\u8d23\u7ba1\u7406\u5ba2\u6237\u7aef(Producer/Consumer)\u548c\u7ef4\u62a4Consumer\u7684Topic\u8ba2\u9605\u4fe1\u606f"),(0,a.kt)("li",{parentName:"ol"},"Store Service\uff1a\u63d0\u4f9b\u65b9\u4fbf\u7b80\u5355\u7684API\u63a5\u53e3\u5904\u7406\u6d88\u606f\u5b58\u50a8\u5230\u7269\u7406\u786c\u76d8\u548c\u67e5\u8be2\u529f\u80fd\u3002"),(0,a.kt)("li",{parentName:"ol"},"HA Service\uff1a\u9ad8\u53ef\u7528\u670d\u52a1\uff0c\u63d0\u4f9bMaster Broker \u548c Slave Broker\u4e4b\u95f4\u7684\u6570\u636e\u540c\u6b65\u529f\u80fd\u3002"),(0,a.kt)("li",{parentName:"ol"},"Index Service\uff1a\u6839\u636e\u7279\u5b9a\u7684Message key\u5bf9\u6295\u9012\u5230Broker\u7684\u6d88\u606f\u8fdb\u884c\u7d22\u5f15\u670d\u52a1\uff0c\u4ee5\u63d0\u4f9b\u6d88\u606f\u7684\u5feb\u901f\u67e5\u8be2\u3002")))),(0,a.kt)("h3",{id:"\u5b89\u88c5rocketmq"},"\u5b89\u88c5RocketMQ"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u4e0b\u8f7dBroker")),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://github.com/apache/rocketmq/releases/tag/rocketmq-all-4.7.1"},"https://github.com/apache/rocketmq/releases/tag/rocketmq-all-4.7.1")),(0,a.kt)("p",null,"\u4e0b\u8f7d\u5b8c\u6bd5\u4e4b\u540e\u89e3\u538b\u5230\u4e00\u4e2a\u6587\u4ef6\u5939\u4e2d"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u7f16\u8bd1")),(0,a.kt)("p",null,"\u8fdb\u5165\u9879\u76ee\u6839\u76ee\u5f55\u540ecmd\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"mvn -Prelease-all -DskipTests clean install -U\ncd distribution\\target\\rocketmq-4.7.1\\rocketmq-4.7.1\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-properties"},'ROCKETMQ_HOME="D:\\rocketmq-rocketmq-all-4.7.1\\distribution\\target\\rocketmq-4.7.1\\rocketmq-4.7.1"\nNAMESRV_ADDR="localhost:9876"\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u542f\u52a8Name Server")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},".\\bin\\mqnamesrv.cmd\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u542f\u52a8\u6210\u529f\u540e\u4f1a\u51fa\u73b0\uff1a",(0,a.kt)("inlineCode",{parentName:"p"},"The Name Server boot success. serializeType=JSON"))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u542f\u52a8Broker Server")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},".\\bin\\mqbroker.cmd -n localhost:9876 autoCreateTopicEnable=true\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u542f\u52a8\u6210\u529f\u540e\u4f1a\u51fa\u73b0\uff1a",(0,a.kt)("inlineCode",{parentName:"p"},"The broker[xxxx, 192.168.199.137:10911] boot success. serializeType=JSON and name server is localhost:9876"))),(0,a.kt)("h4",{id:"\u5b89\u88c5-rocketmq-console-\u53ef\u9009"},"\u5b89\u88c5 RocketMQ Console (\u53ef\u9009)"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"git clone https://github.com/apache/rocketmq-externals.git\ncd ./rocketmq-console\nmvn clean package -Dmaven.test.skip=true\ncd target\njava -jar rocketmq-console-ng-2.0.0.jar --server.port=12581 --rocketmq.config.namesrvAddr=127.0.0.1:9876\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"rocketmq.config.namesrvAddr\uff1aName Server\u7684\u5730\u5740"),(0,a.kt)("p",{parentName:"blockquote"},"\u5728\u542f\u52a8console\u4e4b\u524d\uff0cName Server \u548c Broker Server \u5f97\u5148\u542f\u52a8")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u8bbf\u95ee\u9762\u677f")),(0,a.kt)("p",null,"http://localhost:12581/"),(0,a.kt)("h3",{id:"\u9879\u76ee\u642d\u5efa"},"\u9879\u76ee\u642d\u5efa"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u521b\u5efa\u5de5\u7a0b")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"rocketmq")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u5f15\u5165\u4f9d\u8d56")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-xml"},"\x3c!-- RocketMQ --\x3e\n<dependency>\n    <groupId>org.apache.rocketmq</groupId>\n    <artifactId>rocketmq-client</artifactId>\n    <version>4.7.1</version>\n</dependency>\n\n<dependency>\n    <groupId>junit</groupId>\n    <artifactId>junit</artifactId>\n    <scope>test</scope>\n</dependency>\n")),(0,a.kt)("h3",{id:"\u57fa\u672c\u6837\u4f8b"},"\u57fa\u672c\u6837\u4f8b"),(0,a.kt)("h4",{id:"1producer\u7aef\u53d1\u9001\u540c\u6b65\u6d88\u606f"},"1\u3001Producer\u7aef\u53d1\u9001\u540c\u6b65\u6d88\u606f"),(0,a.kt)("p",null,"\u53d1\u9001\u540c\u6b65\u6d88\u606f\u5373\u8868\u793a\u751f\u4ea7\u8005\u5728\u53d1\u9001\u6d88\u606f\u65f6\u4f1a\u5904\u4e8e\u963b\u585e\u72b6\u6001\uff0c\u76f4\u5230\u6d88\u8d39\u8005\u6d88\u8d39\u5b8c\u8fd9\u6761\u6d88\u606f\u4e3a\u6b62\u5e76\u8fd4\u56de\u4e00\u4e2a\u63a5\u6536\u7684\u7ed3\u679c\u3002\u8fd9\u79cd\u53ef\u9760\u6027\u540c\u6b65\u5730\u53d1\u9001\u65b9\u5f0f\u4f7f\u7528\u7684\u6bd4\u8f83\u5e7f\u6cdb\uff0c\u6bd4\u5982\uff1a\u91cd\u8981\u7684\u6d88\u606f\u901a\u77e5\uff0c\u77ed\u4fe1\u901a\u77e5\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'/**\n * \u53d1\u9001\u540c\u6b65\u6d88\u606f\n */\n@Test\npublic void sendSyncProducer() throws Exception {\n    // \u5b9e\u4f8b\u5316\u6d88\u606f\u751f\u4ea7\u8005Producer\n    DefaultMQProducer producer = new DefaultMQProducer("group1");\n    // \u8bbe\u7f6eNameServer\u7684\u5730\u5740\n    producer.setNamesrvAddr("127.0.0.1:9876");\n    // \u542f\u52a8Producer\u5b9e\u4f8b\n    producer.start();\n    for (int i = 0; i < 10; i++) {\n        // \u521b\u5efa\u6d88\u606f\uff0c\u5e76\u6307\u5b9aTopic\uff0cTag\u548c\u6d88\u606f\u4f53\n        Message msg = new Message("topic1", "tag1",\n                ("Hello RocketMQ " + i).getBytes(RemotingHelper.DEFAULT_CHARSET)\n        );\n        // \u53d1\u9001\u6d88\u606f\u5230\u4e00\u4e2aBroker\n        SendResult sendResult = producer.send(msg);\n        // \u901a\u8fc7sendResult\u8fd4\u56de\u6d88\u606f\u662f\u5426\u6210\u529f\u9001\u8fbe\n        System.out.println(sendResult);\n    }\n    // \u5982\u679c\u4e0d\u518d\u53d1\u9001\u6d88\u606f\uff0c\u5173\u95edProducer\u5b9e\u4f8b\u3002\n    producer.shutdown();\n}\n')),(0,a.kt)("h4",{id:"2\u53d1\u9001\u5f02\u6b65\u6d88\u606f"},"2\u3001\u53d1\u9001\u5f02\u6b65\u6d88\u606f"),(0,a.kt)("p",null,"\u5f02\u6b65\u6d88\u606f\u901a\u5e38\u7528\u5728\u5bf9\u54cd\u5e94\u65f6\u95f4\u654f\u611f\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u5373\u53d1\u9001\u7aef\u4e0d\u80fd\u5bb9\u5fcd\u957f\u65f6\u95f4\u5730\u7b49\u5f85Broker\u7684\u54cd\u5e94\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@Test\npublic void sendAsync() throws Exception{\n    // \u5b9e\u4f8b\u5316\u6d88\u606f\u751f\u4ea7\u8005Producer\n    DefaultMQProducer producer = new DefaultMQProducer("group1");\n    // \u8bbe\u7f6eNameServer\u7684\u5730\u5740\n    producer.setNamesrvAddr("localhost:9876");\n    // \u542f\u52a8Producer\u5b9e\u4f8b\n    producer.start();\n    producer.setRetryTimesWhenSendAsyncFailed(0);\n\n    int messageCount = 10;\n    // \u6839\u636e\u6d88\u606f\u6570\u91cf\u5b9e\u4f8b\u5316\u5012\u8ba1\u65f6\u8ba1\u7b97\u5668\n    final CountDownLatch2 countDownLatch = new CountDownLatch2(messageCount);\n    for (int i = 0; i < messageCount; i++) {\n        final int index = i;\n        // \u521b\u5efa\u6d88\u606f\uff0c\u5e76\u6307\u5b9aTopic\uff0cTag\u548c\u6d88\u606f\u4f53\n        Message msg = new Message("topic1",\n                "TagA",\n                "OrderID188",\n                "Hello world".getBytes(RemotingHelper.DEFAULT_CHARSET));\n        // SendCallback\u63a5\u6536\u5f02\u6b65\u8fd4\u56de\u7ed3\u679c\u7684\u56de\u8c03\n        producer.send(msg, new SendCallback() {\n            @Override\n            public void onSuccess(SendResult sendResult) {\n                System.out.printf("%-10d OK %s %n", index, sendResult.getMsgId());\n            }\n\n            @Override\n            public void onException(Throwable e) {\n                System.out.printf("%-10d Exception %s %n", index, e);\n                e.printStackTrace();\n            }\n        });\n    }\n    // \u7b49\u5f855s\n    countDownLatch.await(5, TimeUnit.SECONDS);\n    // \u5982\u679c\u4e0d\u518d\u53d1\u9001\u6d88\u606f\uff0c\u5173\u95edProducer\u5b9e\u4f8b\u3002\n    producer.shutdown();\n}\n')),(0,a.kt)("h4",{id:"3\u5355\u5411\u53d1\u9001\u6d88\u606f"},"3\u3001\u5355\u5411\u53d1\u9001\u6d88\u606f"),(0,a.kt)("p",null,"\u8fd9\u79cd\u65b9\u5f0f\u4e3b\u8981\u7528\u5728\u4e0d\u7279\u522b\u5173\u5fc3\u53d1\u9001\u7ed3\u679c\u7684\u573a\u666f\uff0c\u4f8b\u5982\u65e5\u5fd7\u53d1\u9001\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@Test\npublic void sendOneway() throws Exception {\n    // \u5b9e\u4f8b\u5316\u6d88\u606f\u751f\u4ea7\u8005Producer\n    DefaultMQProducer producer = new DefaultMQProducer("group1");\n    // \u8bbe\u7f6eNameServer\u7684\u5730\u5740\n    producer.setNamesrvAddr("localhost:9876");\n    // \u542f\u52a8Producer\u5b9e\u4f8b\n    producer.start();\n    for (int i = 0; i < 100; i++) {\n        // \u521b\u5efa\u6d88\u606f\uff0c\u5e76\u6307\u5b9aTopic\uff0cTag\u548c\u6d88\u606f\u4f53\n        Message msg = new Message("topic1" /* Topic */,\n                "TagB" /* Tag */,\n                ("Hello RocketMQ " + i).getBytes(RemotingHelper.DEFAULT_CHARSET) /* Message body */\n        );\n        // \u53d1\u9001\u5355\u5411\u6d88\u606f\uff0c\u6ca1\u6709\u4efb\u4f55\u8fd4\u56de\u7ed3\u679c\n        producer.sendOneway(msg);\n\n    }\n    // \u5982\u679c\u4e0d\u518d\u53d1\u9001\u6d88\u606f\uff0c\u5173\u95edProducer\u5b9e\u4f8b\u3002\n    producer.shutdown();\n}\n')),(0,a.kt)("h4",{id:"4\u6d88\u8d39\u6d88\u606f"},"4\u3001\u6d88\u8d39\u6d88\u606f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'@Test\npublic void consumer() throws Exception {\n    // \u5b9e\u4f8b\u5316\u6d88\u8d39\u8005\n    DefaultMQPushConsumer consumer = new DefaultMQPushConsumer("group1");\n\n    // \u8bbe\u7f6eNameServer\u7684\u5730\u5740\n    consumer.setNamesrvAddr("127.0.0.1:9876");\n\n    // \u8ba2\u9605\u4e00\u4e2a\u6216\u8005\u591a\u4e2aTopic\uff0c\u4ee5\u53caTag\u6765\u8fc7\u6ee4\u9700\u8981\u6d88\u8d39\u7684\u6d88\u606f\n    consumer.subscribe("topic1", "*");\n    // \u6ce8\u518c\u56de\u8c03\u5b9e\u73b0\u7c7b\u6765\u5904\u7406\u4ecebroker\u62c9\u53d6\u56de\u6765\u7684\u6d88\u606f\n    consumer.registerMessageListener(new MessageListenerConcurrently() {\n        @Override\n        public ConsumeConcurrentlyStatus consumeMessage(List<MessageExt> msgs, ConsumeConcurrentlyContext context) {\n            System.out.println(msgs);\n            // \u6807\u8bb0\u8be5\u6d88\u606f\u5df2\u7ecf\u88ab\u6210\u529f\u6d88\u8d39\n            return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;\n        }\n\n    });\n    // \u542f\u52a8\u6d88\u8d39\u8005\u5b9e\u4f8b\n    consumer.start();\n    System.out.println("consumer start...");\n    System.in.read();\n}\n')),(0,a.kt)("h2",{id:"rocketmq-\u6279\u91cf\u6d88\u606f"},"RocketMQ \u6279\u91cf\u6d88\u606f"),(0,a.kt)("h3",{id:"\u6279\u91cf\u6d88\u606f"},"\u6279\u91cf\u6d88\u606f"),(0,a.kt)("p",null,"\u6279\u91cf\u53d1\u9001\u6d88\u606f\u80fd\u663e\u8457\u63d0\u9ad8\u4f20\u9012\u5c0f\u6d88\u606f\u7684\u6027\u80fd\u3002\u9650\u5236\u662f\u8fd9\u4e9b\u6279\u91cf\u6d88\u606f\u5e94\u8be5\u6709\u76f8\u540c\u7684topic\uff0c\u76f8\u540c\u7684waitStoreMsgOK\uff0c\u800c\u4e14\u4e0d\u80fd\u662f\u5ef6\u65f6\u6d88\u606f\u3002\u6b64\u5916\uff0c\u8fd9\u4e00\u6279\u6d88\u606f\u7684\u603b\u5927\u5c0f\u4e0d\u5e94\u8d85\u8fc74MB\u3002"),(0,a.kt)("h3",{id:"\u53d1\u9001\u6279\u91cf\u6d88\u606f"},"\u53d1\u9001\u6279\u91cf\u6d88\u606f"),(0,a.kt)("p",null,"\u5982\u679c\u60a8\u6bcf\u6b21\u53ea\u53d1\u9001\u4e0d\u8d85\u8fc74MB\u7684\u6d88\u606f\uff0c\u5219\u5f88\u5bb9\u6613\u4f7f\u7528\u6279\u5904\u7406\uff0c\u6837\u4f8b\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'String topic = "BatchTest";\nList<Message> messages = new ArrayList<>();\nmessages.add(new Message(topic, "TagA", "OrderID001", "Hello world 0".getBytes()));\nmessages.add(new Message(topic, "TagA", "OrderID002", "Hello world 1".getBytes()));\nmessages.add(new Message(topic, "TagA", "OrderID003", "Hello world 2".getBytes()));\ntry {\n   producer.send(messages);\n} catch (Exception e) {\n   e.printStackTrace();\n   //\u5904\u7406error\n}\n')),(0,a.kt)("h3",{id:"\u6d88\u606f\u5217\u8868\u5206\u5272"},"\u6d88\u606f\u5217\u8868\u5206\u5272"),(0,a.kt)("p",null,"\u590d\u6742\u5ea6\u53ea\u6709\u5f53\u4f60\u53d1\u9001\u5927\u6279\u91cf\u65f6\u624d\u4f1a\u589e\u957f\uff0c\u4f60\u53ef\u80fd\u4e0d\u786e\u5b9a\u5b83\u662f\u5426\u8d85\u8fc7\u4e86\u5927\u5c0f\u9650\u5236\uff084MB\uff09\u3002\u8fd9\u65f6\u5019\u4f60\u6700\u597d\u628a\u4f60\u7684\u6d88\u606f\u5217\u8868\u5206\u5272\u4e00\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"package io.mvvm.batch;\n\nimport org.apache.rocketmq.common.message.Message;\n\nimport java.util.Iterator;\nimport java.util.List;\nimport java.util.Map;\n\n/**\n * \u6d88\u606f\u5217\u8868\u5206\u5272\n */\npublic class ListSplitter implements Iterator<List<Message>> {\n    private final int SIZE_LIMIT = 1024 * 1024 * 4;\n    private final List<Message> messages;\n    private int currIndex;\n\n    public ListSplitter(List<Message> messages) {\n        this.messages = messages;\n    }\n\n    @Override\n    public boolean hasNext() {\n        return currIndex < messages.size();\n    }\n\n    @Override\n    public List<Message> next() {\n        int startIndex = getStartIndex();\n        int nextIndex = startIndex;\n        int totalSize = 0;\n        for (; nextIndex < messages.size(); nextIndex++) {\n            Message message = messages.get(nextIndex);\n            int tmpSize = calcMessageSize(message);\n            if (tmpSize + totalSize > SIZE_LIMIT) {\n                break;\n            } else {\n                totalSize += tmpSize;\n            }\n        }\n        List<Message> subList = messages.subList(startIndex, nextIndex);\n        currIndex = nextIndex;\n        return subList;\n    }\n\n    private int getStartIndex() {\n        Message currMessage = messages.get(currIndex);\n        int tmpSize = calcMessageSize(currMessage);\n        while (tmpSize > SIZE_LIMIT) {\n            currIndex += 1;\n            Message message = messages.get(currIndex);\n            tmpSize = calcMessageSize(message);\n        }\n        return currIndex;\n    }\n\n    private int calcMessageSize(Message message) {\n        int tmpSize = message.getTopic().length() + message.getBody().length;\n        Map<String, String> properties = message.getProperties();\n        for (Map.Entry<String, String> entry : properties.entrySet()) {\n            tmpSize += entry.getKey().length() + entry.getValue().length();\n        }\n        tmpSize = tmpSize + 20; // \u589e\u52a0\u2f47\u65e5\u5fd7\u7684\u5f00\u950020\u5b57\u8282\n        return tmpSize;\n    }\n}\n")),(0,a.kt)("h3",{id:"\u53d1\u9001\u5206\u5272\u540e\u6279\u91cf\u6d88\u606f"},"\u53d1\u9001\u5206\u5272\u540e\u6279\u91cf\u6d88\u606f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'package io.mvvm.batch;\n\nimport org.apache.rocketmq.client.producer.DefaultMQProducer;\nimport org.apache.rocketmq.client.producer.SendResult;\nimport org.apache.rocketmq.common.message.Message;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\n/**\n * @program: spring-cloud-alibaba\n * @description: \u6279\u91cf\u6d88\u606f\u63d0\u4f9b\u8005\n * @author: \u6f58\n * @create: 2020-12-27 22:32\n **/\npublic class Producer {\n\n    public static void main(String[] args) throws Exception{\n        DefaultMQProducer producer = new DefaultMQProducer("group1");\n\n        producer.setNamesrvAddr("127.0.0.1:9876");\n\n        producer.start();\n\n        String topic = "BatchTest";\n        List<Message> messages = new ArrayList<>();\n        messages.add(new Message(topic, "TagA", "OrderID001", "Hello world 0".getBytes()));\n        messages.add(new Message(topic, "TagA", "OrderID002", "Hello world 1".getBytes()));\n        messages.add(new Message(topic, "TagA", "OrderID003", "Hello world 2".getBytes()));\n        //\u628a\u5927\u7684\u6d88\u606f\u5206\u88c2\u6210\u82e5\u5e72\u4e2a\u5c0f\u7684\u6d88\u606f\n        ListSplitter splitter = new ListSplitter(messages);\n        while (splitter.hasNext()) {\n            try {\n                List<Message> listItem = splitter.next();\n                SendResult send = producer.send(listItem);\n                System.out.println(send);\n            } catch (Exception e) {\n                e.printStackTrace();\n                //\u5904\u7406error\n            }\n        }\n    }\n\n}\n')),(0,a.kt)("h3",{id:"\u6279\u91cf\u6d88\u606f\u6d88\u8d39"},"\u6279\u91cf\u6d88\u606f\u6d88\u8d39"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'package io.mvvm.batch;\n\nimport org.apache.rocketmq.client.consumer.DefaultMQPushConsumer;\nimport org.apache.rocketmq.client.consumer.listener.ConsumeOrderlyContext;\nimport org.apache.rocketmq.client.consumer.listener.ConsumeOrderlyStatus;\nimport org.apache.rocketmq.client.consumer.listener.MessageListenerOrderly;\nimport org.apache.rocketmq.common.consumer.ConsumeFromWhere;\nimport org.apache.rocketmq.common.message.MessageExt;\n\nimport java.util.List;\n/**\n * @program: spring-cloud-alibaba\n * @description: \u6279\u91cf\u6d88\u606f\u6d88\u8d39\u8005\n * @author: \u6f58\n * @create: 2020-12-27 22:33\n **/\npublic class Consumer {\n    public static void main(String[] args) throws Exception {\n        DefaultMQPushConsumer consumer = new DefaultMQPushConsumer("group1");\n        consumer.setNamesrvAddr("127.0.0.1:9876");\n        /**\n         * \u8bbe\u7f6eConsumer\u7b2c\u4e00\u6b21\u542f\u52a8\u662f\u4ece\u961f\u5217\u5934\u90e8\u5f00\u59cb\u6d88\u8d39\u8fd8\u662f\u961f\u5217\u5c3e\u90e8\u5f00\u59cb\u6d88\u8d39<br>\n         * \u5982\u679c\u975e\u7b2c\u4e00\u6b21\u542f\u52a8\uff0c\u90a3\u4e48\u6309\u7167\u4e0a\u6b21\u6d88\u8d39\u7684\u4f4d\u7f6e\u7ee7\u7eed\u6d88\u8d39\n         */\n        consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);\n\n        consumer.subscribe("BatchTest", "TagA");\n\n        consumer.registerMessageListener(new MessageListenerOrderly() {\n            @Override\n            public ConsumeOrderlyStatus consumeMessage(List<MessageExt> msgs, ConsumeOrderlyContext context) {\n                context.setAutoCommit(true);\n                for (MessageExt msg : msgs) {\n                    // \u53ef\u4ee5\u770b\u5230\u6bcf\u4e2aqueue\u6709\u552f\u4e00\u7684consume\u7ebf\u7a0b\u6765\u6d88\u8d39, \u8ba2\u5355\u5bf9\u6bcf\u4e2aqueue(\u5206\u533a)\u6709\u5e8f\n                    System.out.println("consumeThread=" + Thread.currentThread().getName() + "queueId=" + msg.getQueueId() + ", content:" + new String(msg.getBody()));\n                }\n                return ConsumeOrderlyStatus.SUCCESS;\n            }\n        });\n\n        consumer.start();\n\n        System.out.println("Consumer Started.");\n        System.in.read();\n    }\n}\n')),(0,a.kt)("h2",{id:"rocketmq-\u987a\u5e8f\u6d88\u606f"},"RocketMQ \u987a\u5e8f\u6d88\u606f"),(0,a.kt)("h3",{id:"\u987a\u5e8f\u6d88\u606f"},"\u987a\u5e8f\u6d88\u606f"),(0,a.kt)("p",null,"\u6d88\u606f\u6709\u5e8f\u6307\u7684\u662f\u4e00\u7c7b\u6d88\u606f\u6d88\u8d39\u65f6\uff0c\u80fd\u6309\u7167\u53d1\u9001\u7684\u987a\u5e8f\u6765\u6d88\u8d39\u3002\u4f8b\u5982\uff1a\u4e00\u4e2a\u8ba2\u5355\u4ea7\u751f\u4e86\u4e09\u6761\u6d88\u606f\u5206\u522b\u662f\u8ba2\u5355\u521b\u5efa\u3001\u8ba2\u5355\u4ed8\u6b3e\u3001\u8ba2\u5355\u5b8c\u6210\u3002\u6d88\u8d39\u65f6\u8981\u6309\u7167\u8fd9\u4e2a\u987a\u5e8f\u6d88\u8d39\u624d\u80fd\u6709\u610f\u4e49\uff0c\u4f46\u662f\u540c\u65f6\u8ba2\u5355\u4e4b\u95f4\u662f\u53ef\u4ee5\u5e76\u884c\u6d88\u8d39\u7684\u3002RocketMQ\u53ef\u4ee5\u4e25\u683c\u7684\u4fdd\u8bc1\u6d88\u606f\u6709\u5e8f\u3002"),(0,a.kt)("p",null,"\u987a\u5e8f\u6d88\u606f\u5206\u4e3a\u5168\u5c40\u987a\u5e8f\u6d88\u606f\u4e0e\u5206\u533a\u987a\u5e8f\u6d88\u606f\uff0c\u5168\u5c40\u987a\u5e8f\u662f\u6307\u67d0\u4e2aTopic\u4e0b\u7684\u6240\u6709\u6d88\u606f\u90fd\u8981\u4fdd\u8bc1\u987a\u5e8f\uff1b\u90e8\u5206\u987a\u5e8f\u6d88\u606f\u53ea\u8981\u4fdd\u8bc1\u6bcf\u4e00\u7ec4\u6d88\u606f\u88ab\u987a\u5e8f\u6d88\u8d39\u5373\u53ef\u3002"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u5168\u5c40\u987a\u5e8f \u5bf9\u4e8e\u6307\u5b9a\u7684\u4e00\u4e2a Topic\uff0c\u6240\u6709\u6d88\u606f\u6309\u7167\u4e25\u683c\u7684\u5148\u5165\u5148\u51fa\uff08FIFO\uff09\u7684\u987a\u5e8f\u8fdb\u884c\u53d1\u5e03\u548c\u6d88\u8d39\u3002 \u9002\u7528\u573a\u666f\uff1a\u6027\u80fd\u8981\u6c42\u4e0d\u9ad8\uff0c\u6240\u6709\u7684\u6d88\u606f\u4e25\u683c\u6309\u7167 FIFO \u539f\u5219\u8fdb\u884c\u6d88\u606f\u53d1\u5e03\u548c\u6d88\u8d39\u7684\u573a\u666f"),(0,a.kt)("li",{parentName:"ul"},"\u5206\u533a\u987a\u5e8f \u5bf9\u4e8e\u6307\u5b9a\u7684\u4e00\u4e2a Topic\uff0c\u6240\u6709\u6d88\u606f\u6839\u636e sharding key \u8fdb\u884c\u533a\u5757\u5206\u533a\u3002 \u540c\u4e00\u4e2a\u5206\u533a\u5185\u7684\u6d88\u606f\u6309\u7167\u4e25\u683c\u7684 FIFO \u987a\u5e8f\u8fdb\u884c\u53d1\u5e03\u548c\u6d88\u8d39\u3002 Sharding key \u662f\u987a\u5e8f\u6d88\u606f\u4e2d\u7528\u6765\u533a\u5206\u4e0d\u540c\u5206\u533a\u7684\u5173\u952e\u5b57\u6bb5\uff0c\u548c\u666e\u901a\u6d88\u606f\u7684 Key \u662f\u5b8c\u5168\u4e0d\u540c\u7684\u6982\u5ff5\u3002 \u9002\u7528\u573a\u666f\uff1a\u6027\u80fd\u8981\u6c42\u9ad8\uff0c\u4ee5 sharding key \u4f5c\u4e3a\u5206\u533a\u5b57\u6bb5\uff0c\u5728\u540c\u4e00\u4e2a\u533a\u5757\u4e2d\u4e25\u683c\u7684\u6309\u7167 FIFO \u539f\u5219\u8fdb\u884c\u6d88\u606f\u53d1\u5e03\u548c\u6d88\u8d39\u7684\u573a\u666f\u3002")),(0,a.kt)("h3",{id:"\u987a\u5e8f\u6d88\u606f\u751f\u4ea7"},"\u987a\u5e8f\u6d88\u606f\u751f\u4ea7"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'package io.mvvm.list;\n\nimport org.apache.rocketmq.client.producer.DefaultMQProducer;\nimport org.apache.rocketmq.client.producer.MessageQueueSelector;\nimport org.apache.rocketmq.client.producer.SendResult;\nimport org.apache.rocketmq.common.message.Message;\nimport org.apache.rocketmq.common.message.MessageQueue;\n\nimport java.text.SimpleDateFormat;\nimport java.util.ArrayList;\nimport java.util.Date;\nimport java.util.List;\n\n/**\n * @program: spring-cloud-alibaba\n * @description: Producer\uff0c\u53d1\u9001\u987a\u5e8f\u6d88\u606f\n * @author: \u6f58\n * @create: 2020-12-27 22:01\n **/\npublic class Producer {\n    public static void main(String[] args) throws Exception {\n        DefaultMQProducer producer = new DefaultMQProducer("group1");\n\n        producer.setNamesrvAddr("127.0.0.1:9876");\n\n        producer.start();\n\n        String[] tags = new String[]{"TagA", "TagC", "TagD"};\n\n        // \u8ba2\u5355\u5217\u8868\n        List<OrderStep> orderList = new Producer().buildOrders();\n\n        Date date = new Date();\n        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");\n        String dateStr = sdf.format(date);\n        for (int i = 0; i < 10; i++) {\n            // \u52a0\u4e2a\u65f6\u95f4\u524d\u7f00\n            String body = dateStr + " Hello RocketMQ " + orderList.get(i);\n            Message msg = new Message("ListTopic", tags[i % tags.length], "KEY" + i, body.getBytes());\n\n            SendResult sendResult = producer.send(msg, new MessageQueueSelector() {\n                @Override\n                public MessageQueue select(List<MessageQueue> mqs, Message msg, Object arg) {\n                    Long id = (Long) arg;  //\u6839\u636e\u8ba2\u5355id\u9009\u62e9\u53d1\u9001queue\n                    long index = id % mqs.size();\n                    return mqs.get((int) index);\n                }\n            }, orderList.get(i).getOrderId());//\u8ba2\u5355id\n\n            System.out.println(String.format("SendResult status:%s, queueId:%d, body:%s",\n                    sendResult.getSendStatus(),\n                    sendResult.getMessageQueue().getQueueId(),\n                    body));\n        }\n\n        producer.shutdown();\n    }\n\n    /**\n     * \u8ba2\u5355\u7684\u6b65\u9aa4\n     */\n    private static class OrderStep {\n        private long orderId;\n        private String desc;\n\n        public long getOrderId() {\n            return orderId;\n        }\n\n        public void setOrderId(long orderId) {\n            this.orderId = orderId;\n        }\n\n        public String getDesc() {\n            return desc;\n        }\n\n        public void setDesc(String desc) {\n            this.desc = desc;\n        }\n\n        @Override\n        public String toString() {\n            return "OrderStep{" +\n                    "orderId=" + orderId +\n                    ", desc=\'" + desc + \'\\\'\' +\n                    \'}\';\n        }\n    }\n\n    /**\n     * \u751f\u6210\u6a21\u62df\u8ba2\u5355\u6570\u636e\n     */\n    private List<OrderStep> buildOrders() {\n        List<OrderStep> orderList = new ArrayList<OrderStep>();\n\n        OrderStep orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103111039L);\n        orderDemo.setDesc("\u521b\u5efa");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103111065L);\n        orderDemo.setDesc("\u521b\u5efa");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103111039L);\n        orderDemo.setDesc("\u4ed8\u6b3e");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103117235L);\n        orderDemo.setDesc("\u521b\u5efa");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103111065L);\n        orderDemo.setDesc("\u4ed8\u6b3e");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103117235L);\n        orderDemo.setDesc("\u4ed8\u6b3e");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103111065L);\n        orderDemo.setDesc("\u5b8c\u6210");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103111039L);\n        orderDemo.setDesc("\u63a8\u9001");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103117235L);\n        orderDemo.setDesc("\u5b8c\u6210");\n        orderList.add(orderDemo);\n\n        orderDemo = new OrderStep();\n        orderDemo.setOrderId(15103111039L);\n        orderDemo.setDesc("\u5b8c\u6210");\n        orderList.add(orderDemo);\n\n        return orderList;\n    }\n}\n')),(0,a.kt)("h3",{id:"\u987a\u5e8f\u6d88\u8d39\u6d88\u606f"},"\u987a\u5e8f\u6d88\u8d39\u6d88\u606f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'package io.mvvm.list;\n\nimport org.apache.rocketmq.client.consumer.DefaultMQPushConsumer;\nimport org.apache.rocketmq.client.consumer.listener.ConsumeOrderlyContext;\nimport org.apache.rocketmq.client.consumer.listener.ConsumeOrderlyStatus;\nimport org.apache.rocketmq.client.consumer.listener.MessageListenerOrderly;\nimport org.apache.rocketmq.common.consumer.ConsumeFromWhere;\nimport org.apache.rocketmq.common.message.MessageExt;\n\nimport java.util.List;\nimport java.util.Random;\nimport java.util.concurrent.TimeUnit;\n\n/**\n * @program: spring-cloud-alibaba\n * @description: \u987a\u5e8f\u6d88\u606f\u6d88\u8d39\uff0c\u5e26\u4e8b\u52a1\u65b9\u5f0f\uff08\u5e94\u7528\u53ef\u63a7\u5236Offset\u4ec0\u4e48\u65f6\u5019\u63d0\u4ea4\uff09\n * @author: \u6f58\n * @create: 2020-12-27 22:06\n **/\npublic class Consumer {\n    public static void main(String[] args) throws Exception {\n        DefaultMQPushConsumer consumer = new DefaultMQPushConsumer("group1");\n        consumer.setNamesrvAddr("127.0.0.1:9876");\n        /**\n         * \u8bbe\u7f6eConsumer\u7b2c\u4e00\u6b21\u542f\u52a8\u662f\u4ece\u961f\u5217\u5934\u90e8\u5f00\u59cb\u6d88\u8d39\u8fd8\u662f\u961f\u5217\u5c3e\u90e8\u5f00\u59cb\u6d88\u8d39<br>\n         * \u5982\u679c\u975e\u7b2c\u4e00\u6b21\u542f\u52a8\uff0c\u90a3\u4e48\u6309\u7167\u4e0a\u6b21\u6d88\u8d39\u7684\u4f4d\u7f6e\u7ee7\u7eed\u6d88\u8d39\n         */\n        consumer.setConsumeFromWhere(ConsumeFromWhere.CONSUME_FROM_FIRST_OFFSET);\n\n        consumer.subscribe("ListTopic", "TagA || TagC || TagD");\n\n        consumer.registerMessageListener(new MessageListenerOrderly() {\n\n            Random random = new Random();\n\n            @Override\n            public ConsumeOrderlyStatus consumeMessage(List<MessageExt> msgs, ConsumeOrderlyContext context) {\n                context.setAutoCommit(true);\n                for (MessageExt msg : msgs) {\n                    // \u53ef\u4ee5\u770b\u5230\u6bcf\u4e2aqueue\u6709\u552f\u4e00\u7684consume\u7ebf\u7a0b\u6765\u6d88\u8d39, \u8ba2\u5355\u5bf9\u6bcf\u4e2aqueue(\u5206\u533a)\u6709\u5e8f\n                    System.out.println("consumeThread=" + Thread.currentThread().getName() + "queueId=" + msg.getQueueId() + ", content:" + new String(msg.getBody()));\n                }\n\n                try {\n                    //\u6a21\u62df\u4e1a\u52a1\u903b\u8f91\u5904\u7406\u4e2d...\n                    TimeUnit.SECONDS.sleep(random.nextInt(10));\n                } catch (Exception e) {\n                    e.printStackTrace();\n                }\n                return ConsumeOrderlyStatus.SUCCESS;\n            }\n        });\n\n        consumer.start();\n\n        System.out.println("Consumer Started.");\n        System.in.read();\n    }\n}\n')),(0,a.kt)("h2",{id:"rocketmq-\u5b9a\u65f6\u6d88\u606f"},"RocketMQ \u5b9a\u65f6\u6d88\u606f"),(0,a.kt)("h3",{id:"\u5b9a\u65f6\u6d88\u606f"},"\u5b9a\u65f6\u6d88\u606f"),(0,a.kt)("p",null,"\u5b9a\u65f6\u6d88\u606f\uff08\u5ef6\u8fdf\u961f\u5217\uff09\u662f\u6307\u6d88\u606f\u53d1\u9001\u5230broker\u540e\uff0c\u4e0d\u4f1a\u7acb\u5373\u88ab\u6d88\u8d39\uff0c\u7b49\u5f85\u7279\u5b9a\u65f6\u95f4\u6295\u9012\u7ed9\u771f\u6b63\u7684topic\u3002 broker\u6709\u914d\u7f6e\u9879messageDelayLevel\uff0c\u9ed8\u8ba4\u503c\u4e3a",(0,a.kt)("inlineCode",{parentName:"p"},"1s 5s 10s 30s 1m 2m 3m 4m 5m 6m 7m 8m 9m 10m 20m 30m 1h 2h"),"\uff0c18\u4e2alevel\u3002\u53ef\u4ee5\u914d\u7f6e\u81ea\u5b9a\u4e49messageDelayLevel\u3002\u6ce8\u610f\uff0cmessageDelayLevel\u662fbroker\u7684\u5c5e\u6027\uff0c\u4e0d\u5c5e\u4e8e\u67d0\u4e2atopic\u3002\u53d1\u6d88\u606f\u65f6\uff0c\u8bbe\u7f6edelayLevel\u7b49\u7ea7\u5373\u53ef\uff1amsg.setDelayLevel(level)\u3002level\u6709\u4ee5\u4e0b\u4e09\u79cd\u60c5\u51b5\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"level == 0\uff0c\u6d88\u606f\u4e3a\u975e\u5ef6\u8fdf\u6d88\u606f"),(0,a.kt)("li",{parentName:"ul"},"1<=level<=maxLevel\uff0c\u6d88\u606f\u5ef6\u8fdf\u7279\u5b9a\u65f6\u95f4\uff0c\u4f8b\u5982level==1\uff0c\u5ef6\u8fdf1s"),(0,a.kt)("li",{parentName:"ul"},"level > maxLevel\uff0c\u5219level== maxLevel\uff0c\u4f8b\u5982level==20\uff0c\u5ef6\u8fdf2h")),(0,a.kt)("p",null,"\u5b9a\u65f6\u6d88\u606f\u4f1a\u6682\u5b58\u5728\u540d\u4e3aSCHEDULE_TOPIC_XXXX\u7684topic\u4e2d\uff0c\u5e76\u6839\u636edelayTimeLevel\u5b58\u5165\u7279\u5b9a\u7684queue\uff0cqueueId = delayTimeLevel \u2013 1\uff0c\u5373\u4e00\u4e2aqueue\u53ea\u5b58\u76f8\u540c\u5ef6\u8fdf\u7684\u6d88\u606f\uff0c\u4fdd\u8bc1\u5177\u6709\u76f8\u540c\u53d1\u9001\u5ef6\u8fdf\u7684\u6d88\u606f\u80fd\u591f\u987a\u5e8f\u6d88\u8d39\u3002broker\u4f1a\u8c03\u5ea6\u5730\u6d88\u8d39SCHEDULE_TOPIC_XXXX\uff0c\u5c06\u6d88\u606f\u5199\u5165\u771f\u5b9e\u7684topic\u3002"),(0,a.kt)("p",null,"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5b9a\u65f6\u6d88\u606f\u4f1a\u5728\u7b2c\u4e00\u6b21\u5199\u5165\u548c\u8c03\u5ea6\u5199\u5165\u771f\u5b9etopic\u65f6\u90fd\u4f1a\u8ba1\u6570\uff0c\u56e0\u6b64\u53d1\u9001\u6570\u91cf\u3001tps\u90fd\u4f1a\u53d8\u9ad8\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u4f7f\u7528\u573a\u666f")),(0,a.kt)("p",null,"\u6bd4\u5982\u7535\u5546\u91cc\uff0c\u63d0\u4ea4\u4e86\u4e00\u4e2a\u8ba2\u5355\u5c31\u53ef\u4ee5\u53d1\u9001\u4e00\u4e2a\u5ef6\u65f6\u6d88\u606f\uff0c1h\u540e\u53bb\u68c0\u67e5\u8fd9\u4e2a\u8ba2\u5355\u7684\u72b6\u6001\uff0c\u5982\u679c\u8fd8\u662f\u672a\u4ed8\u6b3e\u5c31\u53d6\u6d88\u8ba2\u5355\u91ca\u653e\u5e93\u5b58\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u5ef6\u65f6\u6d88\u606f\u7684\u4f7f\u7528\u9650\u5236")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'// org/apache/rocketmq/store/config/MessageStoreConfig.java\nprivate String messageDelayLevel = "1s 5s 10s 30s 1m 2m 3m 4m 5m 6m 7m 8m 9m 10m 20m 30m 1h 2h";\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u73b0\u5728RocketMq\u5e76\u4e0d\u652f\u6301\u4efb\u610f\u65f6\u95f4\u7684\u5ef6\u65f6\uff0c\u9700\u8981\u8bbe\u7f6e\u51e0\u4e2a\u56fa\u5b9a\u7684\u5ef6\u65f6\u7b49\u7ea7\uff0c\u4ece1s\u52302h\u5206\u522b\u5bf9\u5e94\u7740\u7b49\u7ea71\u523018 \u6d88\u606f\u6d88\u8d39\u5931\u8d25\u4f1a\u8fdb\u5165\u5ef6\u65f6\u6d88\u606f\u961f\u5217\uff0c\u6d88\u606f\u53d1\u9001\u65f6\u95f4\u4e0e\u8bbe\u7f6e\u7684\u5ef6\u65f6\u7b49\u7ea7\u548c\u91cd\u8bd5\u6b21\u6570\u6709\u5173\uff0c\u8be6\u89c1\u4ee3\u7801",(0,a.kt)("inlineCode",{parentName:"p"},"SendMessageProcessor.java"))),(0,a.kt)("h3",{id:"\u542f\u52a8\u6d88\u8d39\u8005\u7b49\u5f85\u4f20\u5165\u8ba2\u9605\u6d88\u606f"},"\u542f\u52a8\u6d88\u8d39\u8005\u7b49\u5f85\u4f20\u5165\u8ba2\u9605\u6d88\u606f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'package io.mvvm.scheduled;\n\nimport org.apache.rocketmq.client.consumer.DefaultMQPushConsumer;\nimport org.apache.rocketmq.client.consumer.listener.ConsumeConcurrentlyContext;\nimport org.apache.rocketmq.client.consumer.listener.ConsumeConcurrentlyStatus;\nimport org.apache.rocketmq.client.consumer.listener.MessageListenerConcurrently;\nimport org.apache.rocketmq.common.message.MessageExt;\n\nimport java.util.List;\n\n/**\n * @program: spring-cloud-alibaba\n * @description: \u5b9a\u65f6\u6d88\u606f\u6d88\u8d39\u8005\n * @author: \u6f58\n * @create: 2020-12-27 22:17\n **/\npublic class Consumer {\n    public static void main(String[] args) throws Exception {\n        // \u5b9e\u4f8b\u5316\u6d88\u8d39\u8005\n        DefaultMQPushConsumer consumer = new DefaultMQPushConsumer("group1");\n        // \u8ba2\u9605Topics\n        consumer.subscribe("ScheduledTopic", "*");\n        // \u6ce8\u518c\u6d88\u606f\u76d1\u542c\u8005\n        consumer.registerMessageListener(new MessageListenerConcurrently() {\n            @Override\n            public ConsumeConcurrentlyStatus consumeMessage(List<MessageExt> messages, ConsumeConcurrentlyContext context) {\n                for (MessageExt message : messages) {\n                    // Print approximate delay time period\n                    System.out.println("Receive message[msgId=" + message.getMsgId() + "] " + (System.currentTimeMillis() - message.getStoreTimestamp()) + "ms later");\n                }\n                return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;\n            }\n        });\n        // \u542f\u52a8\u6d88\u8d39\u8005\n        consumer.start();\n        System.in.read();\n    }\n}\n')),(0,a.kt)("h3",{id:"\u53d1\u9001\u5ef6\u65f6\u6d88\u606f"},"\u53d1\u9001\u5ef6\u65f6\u6d88\u606f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'package io.mvvm.scheduled;\n\nimport org.apache.rocketmq.client.producer.DefaultMQProducer;\nimport org.apache.rocketmq.common.message.Message;\n\n/**\n * @program: spring-cloud-alibaba\n * @description: \u5b9a\u65f6\u6d88\u606f\u63d0\u4f9b\u8005\n * @author: \u6f58\n * @create: 2020-12-27 22:17\n **/\npublic class Producer {\n    public static void main(String[] args) throws Exception {\n        // \u5b9e\u4f8b\u5316\u4e00\u4e2a\u751f\u4ea7\u8005\u6765\u4ea7\u751f\u5ef6\u65f6\u6d88\u606f\n        DefaultMQProducer producer = new DefaultMQProducer("group1");\n        // \u542f\u52a8\u751f\u4ea7\u8005\n        producer.start();\n        int totalMessagesToSend = 100;\n        for (int i = 0; i < totalMessagesToSend; i++) {\n            Message message = new Message("ScheduledTopic", ("Hello scheduled message " + i).getBytes());\n            // \u8bbe\u7f6e\u5ef6\u65f6\u7b49\u7ea73,\u8fd9\u4e2a\u6d88\u606f\u5c06\u572810s\u4e4b\u540e\u53d1\u9001(\u73b0\u5728\u53ea\u652f\u6301\u56fa\u5b9a\u7684\u51e0\u4e2a\u65f6\u95f4,\u8be6\u770bdelayTimeLevel)\n            message.setDelayTimeLevel(3);\n            // \u53d1\u9001\u6d88\u606f\n            producer.send(message);\n        }\n        // \u5173\u95ed\u751f\u4ea7\u8005\n        producer.shutdown();\n    }\n}\n')),(0,a.kt)("h2",{id:"rocketmq-\u4e8b\u52a1\u6d88\u606f"},"RocketMQ \u4e8b\u52a1\u6d88\u606f"),(0,a.kt)("h3",{id:"\u4e8b\u52a1\u6d88\u606f"},"\u4e8b\u52a1\u6d88\u606f"),(0,a.kt)("p",null,"RocketMQ\u4e8b\u52a1\u6d88\u606f\uff08Transactional Message\uff09\u662f\u6307\u5e94\u7528\u672c\u5730\u4e8b\u52a1\u548c\u53d1\u9001\u6d88\u606f\u64cd\u4f5c\u53ef\u4ee5\u88ab\u5b9a\u4e49\u5230\u5168\u5c40\u4e8b\u52a1\u4e2d\uff0c\u8981\u4e48\u540c\u65f6\u6210\u529f\uff0c\u8981\u4e48\u540c\u65f6\u5931\u8d25\u3002RocketMQ\u7684\u4e8b\u52a1\u6d88\u606f\u63d0\u4f9b\u7c7b\u4f3c X/Open XA \u7684\u5206\u5e03\u4e8b\u52a1\u529f\u80fd\uff0c\u901a\u8fc7\u4e8b\u52a1\u6d88\u606f\u80fd\u8fbe\u5230\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u6700\u7ec8\u4e00\u81f4\u3002"),(0,a.kt)("p",null,"\u4e8b\u52a1\u6d88\u606f\u5171\u6709\u4e09\u79cd\u72b6\u6001\uff0c\u63d0\u4ea4\u72b6\u6001\u3001\u56de\u6eda\u72b6\u6001\u3001\u4e2d\u95f4\u72b6\u6001\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"TransactionStatus.CommitTransaction: \u63d0\u4ea4\u4e8b\u52a1\uff0c\u5b83\u5141\u8bb8\u6d88\u8d39\u8005\u6d88\u8d39\u6b64\u6d88\u606f\u3002"),(0,a.kt)("li",{parentName:"ul"},"TransactionStatus.RollbackTransaction: \u56de\u6eda\u4e8b\u52a1\uff0c\u5b83\u4ee3\u8868\u8be5\u6d88\u606f\u5c06\u88ab\u5220\u9664\uff0c\u4e0d\u5141\u8bb8\u88ab\u6d88\u8d39\u3002"),(0,a.kt)("li",{parentName:"ul"},"TransactionStatus.Unknown: \u4e2d\u95f4\u72b6\u6001\uff0c\u5b83\u4ee3\u8868\u9700\u8981\u68c0\u67e5\u6d88\u606f\u961f\u5217\u6765\u786e\u5b9a\u72b6\u6001\u3002")),(0,a.kt)("h4",{id:"\u53d1\u9001\u4e8b\u52a1\u6d88\u606f"},"\u53d1\u9001\u4e8b\u52a1\u6d88\u606f"),(0,a.kt)("p",null,"\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"TransactionMQProducer"),"\u7c7b\u521b\u5efa\u751f\u4ea7\u8005\uff0c\u5e76\u6307\u5b9a\u552f\u4e00\u7684 ",(0,a.kt)("inlineCode",{parentName:"p"},"ProducerGroup"),"\uff0c\u5c31\u53ef\u4ee5\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60\u6765\u5904\u7406\u8fd9\u4e9b\u68c0\u67e5\u8bf7\u6c42\u3002\u6267\u884c\u672c\u5730\u4e8b\u52a1\u540e\u3001\u9700\u8981\u6839\u636e\u6267\u884c\u7ed3\u679c\u5bf9\u6d88\u606f\u961f\u5217\u8fdb\u884c\u56de\u590d\u3002\u56de\u4f20\u7684\u4e8b\u52a1\u72b6\u6001\u5728\u8bf7\u53c2\u8003\u524d\u4e00\u8282\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},'package io.mvvm.transaction;\n\nimport org.apache.rocketmq.client.exception.MQClientException;\nimport org.apache.rocketmq.client.producer.SendResult;\nimport org.apache.rocketmq.client.producer.TransactionListener;\nimport org.apache.rocketmq.client.producer.TransactionMQProducer;\nimport org.apache.rocketmq.common.message.Message;\nimport org.apache.rocketmq.remoting.common.RemotingHelper;\n\nimport java.io.UnsupportedEncodingException;\nimport java.util.concurrent.*;\n\n/**\n * @program: spring-cloud-alibaba\n * @description: \u53d1\u9001\u4e8b\u52a1\u6d88\u606f\n * @author: \u6f58\n * @create: 2020-12-31 22:15\n **/\npublic class Producer {\n    public static void main(String[] args) throws MQClientException, InterruptedException {\n        TransactionListener transactionListener = new TransactionListenerImpl();\n        TransactionMQProducer producer = new TransactionMQProducer("please_rename_unique_group_name");\n        ExecutorService executorService = new ThreadPoolExecutor(2, 5, 100,\n                TimeUnit.SECONDS, new ArrayBlockingQueue<Runnable>(2000), new ThreadFactory() {\n            @Override\n            public Thread newThread(Runnable r) {\n                Thread thread = new Thread(r);\n                thread.setName("client-transaction-msg-check-thread");\n                return thread;\n            }\n        });\n        producer.setExecutorService(executorService);\n        producer.setTransactionListener(transactionListener);\n        producer.start();\n        String[] tags = new String[] {"TagA", "TagB", "TagC", "TagD", "TagE"};\n        for (int i = 0; i < 10; i++) {\n            try {\n                Message msg =\n                        new Message("TopicTest1234", tags[i % tags.length], "KEY" + i,\n                                ("Hello RocketMQ " + i).getBytes(RemotingHelper.DEFAULT_CHARSET));\n                SendResult sendResult = producer.sendMessageInTransaction(msg, null);\n                System.out.printf("%s%n", sendResult);\n                Thread.sleep(10);\n            } catch (MQClientException | UnsupportedEncodingException e) {\n                e.printStackTrace();\n            }\n        }\n        for (int i = 0; i < 100000; i++) {\n            Thread.sleep(1000);\n        }\n        producer.shutdown();\n    }\n}\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u5b9e\u73b0\u4e8b\u52a1\u7684\u76d1\u542c\u63a5\u53e3")),(0,a.kt)("p",null,"\u5f53\u53d1\u9001\u534a\u6d88\u606f\u6210\u529f\u65f6\uff0c\u6211\u4eec\u4f7f\u7528 ",(0,a.kt)("inlineCode",{parentName:"p"},"executeLocalTransaction")," \u65b9\u6cd5\u6765\u6267\u884c\u672c\u5730\u4e8b\u52a1\u3002\u5b83\u8fd4\u56de\u524d\u4e00\u8282\u4e2d\u63d0\u5230\u7684\u4e09\u4e2a\u4e8b\u52a1\u72b6\u6001\u4e4b\u4e00\u3002",(0,a.kt)("inlineCode",{parentName:"p"},"checkLocalTransaction")," \u65b9\u6cd5\u7528\u4e8e\u68c0\u67e5\u672c\u5730\u4e8b\u52a1\u72b6\u6001\uff0c\u5e76\u56de\u5e94\u6d88\u606f\u961f\u5217\u7684\u68c0\u67e5\u8bf7\u6c42\u3002\u5b83\u4e5f\u662f\u8fd4\u56de\u524d\u4e00\u8282\u4e2d\u63d0\u5230\u7684\u4e09\u4e2a\u4e8b\u52a1\u72b6\u6001\u4e4b\u4e00\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-java"},"package io.mvvm.transaction;\n\nimport org.apache.rocketmq.client.producer.LocalTransactionState;\nimport org.apache.rocketmq.client.producer.TransactionListener;\nimport org.apache.rocketmq.common.message.Message;\nimport org.apache.rocketmq.common.message.MessageExt;\n\nimport java.util.concurrent.ConcurrentHashMap;\nimport java.util.concurrent.atomic.AtomicInteger;\n\npublic class TransactionListenerImpl implements TransactionListener {\n  private AtomicInteger transactionIndex = new AtomicInteger(0);\n  private ConcurrentHashMap<String, Integer> localTrans = new ConcurrentHashMap<>();\n  @Override\n  public LocalTransactionState executeLocalTransaction(Message msg, Object arg) {\n      int value = transactionIndex.getAndIncrement();\n      int status = value % 3;\n      localTrans.put(msg.getTransactionId(), status);\n      return LocalTransactionState.UNKNOW;\n  }\n  @Override\n  public LocalTransactionState checkLocalTransaction(MessageExt msg) {\n      Integer status = localTrans.get(msg.getTransactionId());\n      if (null != status) {\n          switch (status) {\n              case 0:\n                  return LocalTransactionState.UNKNOW;\n              case 1:\n                  return LocalTransactionState.COMMIT_MESSAGE;\n              case 2:\n                  return LocalTransactionState.ROLLBACK_MESSAGE;\n          }\n      }\n      return LocalTransactionState.COMMIT_MESSAGE;\n  }\n}\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"\u4e8b\u52a1\u6d88\u606f\u4f7f\u7528\u4e0a\u7684\u9650\u5236")),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u4e8b\u52a1\u6d88\u606f\u4e0d\u652f\u6301\u5ef6\u65f6\u6d88\u606f\u548c\u6279\u91cf\u6d88\u606f\u3002"),(0,a.kt)("li",{parentName:"ol"},"\u4e3a\u4e86\u907f\u514d\u5355\u4e2a\u6d88\u606f\u88ab\u68c0\u67e5\u592a\u591a\u6b21\u800c\u5bfc\u81f4\u534a\u961f\u5217\u6d88\u606f\u7d2f\u79ef\uff0c\u6211\u4eec\u9ed8\u8ba4\u5c06\u5355\u4e2a\u6d88\u606f\u7684\u68c0\u67e5\u6b21\u6570\u9650\u5236\u4e3a 15 \u6b21\uff0c\u4f46\u662f\u7528\u6237\u53ef\u4ee5\u901a\u8fc7 Broker \u914d\u7f6e\u6587\u4ef6\u7684 ",(0,a.kt)("inlineCode",{parentName:"li"},"transactionCheckMax"),"\u53c2\u6570\u6765\u4fee\u6539\u6b64\u9650\u5236\u3002\u5982\u679c\u5df2\u7ecf\u68c0\u67e5\u67d0\u6761\u6d88\u606f\u8d85\u8fc7 N \u6b21\u7684\u8bdd\uff08 N = ",(0,a.kt)("inlineCode",{parentName:"li"},"transactionCheckMax")," \uff09 \u5219 Broker \u5c06\u4e22\u5f03\u6b64\u6d88\u606f\uff0c\u5e76\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u540c\u65f6\u6253\u5370\u9519\u8bef\u65e5\u5fd7\u3002\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u91cd\u5199 ",(0,a.kt)("inlineCode",{parentName:"li"},"AbstractTransactionalMessageCheckListener")," \u7c7b\u6765\u4fee\u6539\u8fd9\u4e2a\u884c\u4e3a\u3002"),(0,a.kt)("li",{parentName:"ol"},"\u4e8b\u52a1\u6d88\u606f\u5c06\u5728 Broker \u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u53c2\u6570 transactionTimeout \u8fd9\u6837\u7684\u7279\u5b9a\u65f6\u95f4\u957f\u5ea6\u4e4b\u540e\u88ab\u68c0\u67e5\u3002\u5f53\u53d1\u9001\u4e8b\u52a1\u6d88\u606f\u65f6\uff0c\u7528\u6237\u8fd8\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u7528\u6237\u5c5e\u6027 CHECK_IMMUNITY_TIME_IN_SECONDS \u6765\u6539\u53d8\u8fd9\u4e2a\u9650\u5236\uff0c\u8be5\u53c2\u6570\u4f18\u5148\u4e8e ",(0,a.kt)("inlineCode",{parentName:"li"},"transactionTimeout")," \u53c2\u6570\u3002"),(0,a.kt)("li",{parentName:"ol"},"\u4e8b\u52a1\u6027\u6d88\u606f\u53ef\u80fd\u4e0d\u6b62\u4e00\u6b21\u88ab\u68c0\u67e5\u6216\u6d88\u8d39\u3002"),(0,a.kt)("li",{parentName:"ol"},"\u63d0\u4ea4\u7ed9\u7528\u6237\u7684\u76ee\u6807\u4e3b\u9898\u6d88\u606f\u53ef\u80fd\u4f1a\u5931\u8d25\uff0c\u76ee\u524d\u8fd9\u4f9d\u65e5\u5fd7\u7684\u8bb0\u5f55\u800c\u5b9a\u3002\u5b83\u7684\u9ad8\u53ef\u7528\u6027\u901a\u8fc7 RocketMQ \u672c\u8eab\u7684\u9ad8\u53ef\u7528\u6027\u673a\u5236\u6765\u4fdd\u8bc1\uff0c\u5982\u679c\u5e0c\u671b\u786e\u4fdd\u4e8b\u52a1\u6d88\u606f\u4e0d\u4e22\u5931\u3001\u5e76\u4e14\u4e8b\u52a1\u5b8c\u6574\u6027\u5f97\u5230\u4fdd\u8bc1\uff0c\u5efa\u8bae\u4f7f\u7528\u540c\u6b65\u7684\u53cc\u91cd\u5199\u5165\u673a\u5236\u3002"),(0,a.kt)("li",{parentName:"ol"},"\u4e8b\u52a1\u6d88\u606f\u7684\u751f\u4ea7\u8005 ID \u4e0d\u80fd\u4e0e\u5176\u4ed6\u7c7b\u578b\u6d88\u606f\u7684\u751f\u4ea7\u8005 ID \u5171\u4eab\u3002\u4e0e\u5176\u4ed6\u7c7b\u578b\u7684\u6d88\u606f\u4e0d\u540c\uff0c\u4e8b\u52a1\u6d88\u606f\u5141\u8bb8\u53cd\u5411\u67e5\u8be2\u3001MQ\u670d\u52a1\u5668\u80fd\u901a\u8fc7\u5b83\u4eec\u7684\u751f\u4ea7\u8005 ID \u67e5\u8be2\u5230\u6d88\u8d39\u8005\u3002")))}d.isMDXComponent=!0}}]);