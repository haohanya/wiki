<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-后端/JDK/Nio">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">NIO | My Doc</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-test-site.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-test-site.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/docs/后端/JDK/Nio"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="NIO | My Doc"><meta data-rh="true" name="description" content="什么是 Java NIO"><meta data-rh="true" property="og:description" content="什么是 Java NIO"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/docs/后端/JDK/Nio"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/后端/JDK/Nio" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/后端/JDK/Nio" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Doc RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Doc Atom Feed"><link rel="stylesheet" href="/assets/css/styles.781e9e86.css">
<link rel="preload" href="/assets/js/runtime~main.3e06b88d.js" as="script">
<link rel="preload" href="/assets/js/main.e1a27cf4.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_dYNx" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Doc" class="themedImage_rLhL themedImage--light_CjtC"><img src="/img/logo.svg" alt="My Doc" class="themedImage_rLhL themedImage--dark_quyK"></div><b class="navbar__title text--truncate">My Doc</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">doc</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/pannanxu/wiki" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_TSiV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_uxSF colorModeToggle_S3Zp"><button class="clean-btn toggleButton_VmvJ toggleButtonDisabled_FOd7" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_LA5r"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_LEBj"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ldyj"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_MxCR docsWrapper_h_X8"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_Kzpt" type="button"></button><div class="docPage_GWs5"><aside class="theme-doc-sidebar-container docSidebarContainer_ldoy"><div class="sidebarViewport_TwFD"><div class="sidebar_H_01"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_J18w"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/后端">后端</a><button aria-label="Toggle the collapsible sidebar category &#x27;后端&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/后端/Caddy">Caddy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/后端/Docker">Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/后端/Flowable">Flawable</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/后端/Git">Git</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/后端/JDK/Bio">JDK</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/后端/JDK/Bio">BIO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/后端/JDK/JDK源码">JDK 源码</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/后端/JDK/Nio">NIO</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/后端/Linux">Linux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/后端/MacOsM1">MacOS 环境配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/后端/Netty">Netty</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/后端/Nginx">Nginx</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/后端/Shell">Shell</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/后端/Spring/源码">Spring</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/后端/SpringCloud/">SpringCloud</a><button aria-label="Toggle the collapsible sidebar category &#x27;SpringCloud&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/后端/Vim">Vim</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/后端/kubernetes/安装">kubernetes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/后端/中间件/RocketMQ">中间件</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/后端/微信开发/微信公众号">微信开发</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/后端/数据库/HBase">数据库</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/后端/设计模式/">创建型模式</a><button aria-label="Toggle the collapsible sidebar category &#x27;创建型模式&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/后端/面试题">面试题</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/前端/ViteJs">前端</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/年终&amp;未来/2022">年终&amp;未来</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/模板/技术设计模板">模板</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_baW4"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Njrt"><div class="docItemContainer_ZzVP"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_HWXL" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_IT7R"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/后端"><span itemprop="name">后端</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">JDK</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">NIO</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_GIgr theme-doc-toc-mobile tocMobile_JEhh"><button type="button" class="clean-btn tocCollapsibleButton_Q9up">On this page</button></div><div class="theme-doc-markdown markdown"><h1>NIO</h1><h3 class="anchor anchorWithStickyNavbar_er05" id="什么是-java-nio">什么是 Java NIO<a href="#什么是-java-nio" class="hash-link" aria-label="Direct link to 什么是 Java NIO" title="Direct link to 什么是 Java NIO">​</a></h3><p>Java NIO（java non-blockIng IO）是指 JDK1.4 及以上版本里提供的权限 Api （New IO），为所有的原始类型（boolean类型除外）提供缓存支持的数据容器，使用它可以提供非阻塞式的该伸缩性能网络</p><p>NIO 相关的类都放在 <code>java.nio</code> 包及子包中</p><p>NIO 有三大核心部分：Channel（通道）、Buffer（缓冲区）、Selector（选择器）</p><p>NIO 是面向缓冲区，或面向块编程的。数据读取到一个它处理的缓冲区，需要时可以在缓冲区中前后移动，这就增加了处理过程中的灵活性，使用它可以提供非阻塞的高伸缩性网络</p><p>Java NIO 的非阻塞模式，使一个宪曾从某通道发送请求或者读取数据，但是它技能得到日期前可用的数据，如果目前没有数据可用时，就什么都不会获取，而不是保持线程阻塞，所以直至数据便的可以读取之前，该线程可以继续做其他的事情，非阻塞写也是如此，一个线程请求写入一些数据到某通道，但不需要等待它完全写入，这个县城同事可以去做别的事情</p><p><strong>简单说，NIO 是可以做到用一个线程来处理多个操作。</strong></p><h3 class="anchor anchorWithStickyNavbar_er05" id="nio-和-bio-的比较">NIO 和 BIO 的比较<a href="#nio-和-bio-的比较" class="hash-link" aria-label="Direct link to NIO 和 BIO 的比较" title="Direct link to NIO 和 BIO 的比较">​</a></h3><ol><li>BIO 以流的方式处理数据，而 NIO 以缓冲区的方式处理数据，缓冲区的效率比流的效率高很多</li><li>BIO 是阻塞的，NIO 是非阻塞的</li><li>BIO 基于字节流和字符流进行操作，而 NIO 基于 Channel 和 Buffer 进行操作，<code>数据总是从通道去读到缓冲区中</code>，或者<code>从缓冲区写入到通道中</code>。Selector 用于建通多个通道的事件（比如：连接请求，数据到达等），因此使用单个线程就可以监听多个客户端通道</li></ol><h3 class="anchor anchorWithStickyNavbar_er05" id="缓冲区">缓冲区<a href="#缓冲区" class="hash-link" aria-label="Direct link to 缓冲区" title="Direct link to 缓冲区">​</a></h3><h4 class="anchor anchorWithStickyNavbar_er05" id="什么是缓冲区">什么是缓冲区<a href="#什么是缓冲区" class="hash-link" aria-label="Direct link to 什么是缓冲区" title="Direct link to 什么是缓冲区">​</a></h4><p>缓冲区（Buffer）：本值上是一个<code>可以读写数据的内存块</code>，也可也理解成<code>容器对象(含数组)</code>，该对象提供了一组方法，可以更轻松的使用内存块，缓冲区对象内置了一些机制，能够跟踪和记录缓冲区的状态变化情况。Channel 提供从文件、网络读取数据的通道，但是读取和写入的数据都必须由 Buffer 实现</p><h4 class="anchor anchorWithStickyNavbar_er05" id="buffer-类和子类">Buffer 类和子类<a href="#buffer-类和子类" class="hash-link" aria-label="Direct link to Buffer 类和子类" title="Direct link to Buffer 类和子类">​</a></h4><p>在 NIO 中，Buffer 是一个顶层父类，它是一个抽象类</p><p><img loading="lazy" src="https://img-ages-test0001.oss-cn-hangzhou.aliyuncs.com/images/image-20210117200202929.png" alt="image-20210117200202929" class="img_Ne1E"></p><blockquote><p><code>CharBuffer</code>：存储字符数据到缓冲区</p><p><code>FloatBuffer</code>：存储小数到缓冲区</p><p><code>IntBuffer</code>：存储整数到缓冲区</p><p><code>ByteBUffer</code>：存储字节数据到缓冲区</p><p><code>DoubleBuffer</code>：存储小数到缓冲区</p><p><code>LongBuffer</code>：存储长整形到缓冲区</p><p><code>ShortBuffer</code>：存储字符串到缓冲区</p></blockquote><p>Buffer 类定义了所有的缓冲区都具有的四个属性来提供关于其所包含的数据元素的信息</p><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">// Invariants: mark &lt;= position &lt;= limit &lt;= capacity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private int mark = -1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private int position = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private int limit;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private int capacity;</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><code>mark</code>：标记</p><p><code>position</code>：位置，下一个要被读取或者写入的元素的索引，每次读写缓存数据时都会改变这个值，为下次读写操作做准备</p><p><code>limit</code>：表示缓冲区的当前终点，不能对缓冲区超过极限的位置进行读写操作。且极限是可以修改的</p><p><code>capacity</code>：容量，即可以容纳的最大数据量。在缓冲区创建时被设定，且不能改变</p></blockquote><p><strong>Buffer 类相关方法</strong></p><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">public abstract class Buffer {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // JKD1.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public final int capacity() // 返回此缓冲区的容量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public final int position() // 返回此缓冲区的位置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public final Buffer position(int newPosition) // 设置此缓冲区的位置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public final int limit() // 返回此缓冲区的限制</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public final Buffer limit(int newLimit) // 设置此缓冲区的限制</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public final Buffer mark() // 在此缓冲区的位置设置标记</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public final Buffer reset() // 将此缓冲区的位置重置为以前标记的位置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public final Buffer clear() // 清除此缓冲区，即将各个标记恢复到初始状态，但是数据并没有真正擦除</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public final Buffer flip() // 反转此缓冲区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public final Buffer rewind() // 重绕此缓冲区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public final int remaining() // 返回当前位置与限制之间的元素数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public final boolean hasRemaining() // 告知此缓冲区是否为只读缓冲区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public abstract boolean isReadOnly(); // 告知此缓冲区是否为只读缓冲区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // JDK1.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public abstract boolean hasArray(); // 告知此缓冲区是否具有可访问的底层实现数组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public abstract Object array(); // 返回此缓冲区的底层实现数组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public abstract int arrayOffset(); // 返回此缓冲区的底层实现数组中第一个缓冲区元素的偏移量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public abstract boolean isDirect(); // 告知此缓冲区是否为直接缓冲区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_er05" id="bytebuffer">ByteBuffer<a href="#bytebuffer" class="hash-link" aria-label="Direct link to ByteBuffer" title="Direct link to ByteBuffer">​</a></h4><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">public abstract class ByteBuffer {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 缓冲区创建相关API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static ByteBuffer allocateDirect(int capacity); // 创建直接缓冲区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static ByteBuffer allocate(int capacity); // 设置缓冲区的初始容量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static ByteBuffer wrap(byte[] array, int offset, int length); // 构造初始化位置 offset 和上界 length 的缓冲区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static ByteBuffer wrap(byte[] array); // 吧一个数组放到缓冲区中使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 缓存区存取相关API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public abstract byte get(); // 从当前位置 position 上get，get之后，position会自动 + 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public abstract byte get(int index); // 从绝对位置get</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public abstract ByteBuffer put(byte b); // 从当前位置上添加，put之后，position会自动 - 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public abstract ByteBuffer put(int index, byte b); // 从绝对位置上put</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_er05" id="通道channel">通道（Channel）<a href="#通道channel" class="hash-link" aria-label="Direct link to 通道（Channel）" title="Direct link to 通道（Channel）">​</a></h3><h4 class="anchor anchorWithStickyNavbar_er05" id="什么是-channel">什么是 Channel<a href="#什么是-channel" class="hash-link" aria-label="Direct link to 什么是 Channel" title="Direct link to 什么是 Channel">​</a></h4><p>Nio 的通道类似于流但是有一部分区别</p><ol><li>通道可以同事进行读写，而流只能读或者写</li><li>通道可以实现异步读写数据</li><li>通道可以从缓冲区读数据，也可也写数据到缓冲区</li></ol><p>BIO 中的 <code>Stream</code> 是单向的，例如 <code>FileInputStream</code> 只能进行读取数据的操作，而 NIO 中的 <code>Channel</code> 是双向的，可以进行读和写操作</p><p>Channel 在 NIO 中是一个接口<code>public interface Channel extends Closeable{}</code></p><p>常用的 Channel 类有： FileChannel、DatagramChannel、ServerSocketChannel、SocketChannel</p><blockquote><p><code>FileChannel</code> 用于文件的数据读写</p><p><code>DatagramChannel</code> 用于 UDP 的数据读写</p><p><code>ServerSocketChannel</code>和<code>SocketChannel </code>用于 TCP 的数据读写</p><p><code>ServerSocketChannel</code> 类似于BIO中的 <code>ServerSocket</code></p><p><code>SocketChannel</code> 类似于BIO中的 <code>Socket</code></p></blockquote><h4 class="anchor anchorWithStickyNavbar_er05" id="filechannel-类">FileChannel 类<a href="#filechannel-类" class="hash-link" aria-label="Direct link to FileChannel 类" title="Direct link to FileChannel 类">​</a></h4><p>FileChannel 主要用来对本地文件进行IO操作，常见的方法如下</p><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">public abstract int read(ByteBuffer dst) throws IOException; // 从通道读取数据并放到缓冲区中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public abstract int write(ByteBuffer src) throws IOException; // 吧缓冲区的数据写道通道中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 吧数据从当前通道赋值给目标通道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public abstract long transferTo(long position, long count, WritableByteChannel target) throws IOException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 从目标通道中赋值数据到当前通道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public abstract long transferFrom(ReadableByteChannel src, long position, long count) throws IOException;</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_er05" id="filechannel-example">FileChannel Example<a href="#filechannel-example" class="hash-link" aria-label="Direct link to FileChannel Example" title="Direct link to FileChannel Example">​</a></h4><h5 class="anchor anchorWithStickyNavbar_er05" id="本地文件写入">本地文件写入<a href="#本地文件写入" class="hash-link" aria-label="Direct link to 本地文件写入" title="Direct link to 本地文件写入">​</a></h5><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">package io.mvvm.nio.channel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.FileOutputStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.ByteBuffer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.channels.FileChannel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.charset.StandardCharsets;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @program: Netty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @description: FileChannel 写入</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author: 潘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @create: 2021-01-17 20:51</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> **/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class FileChannelWriteExample {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String name = &quot;zhangsan&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 创建一个输出流</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileOutputStream stream = new FileOutputStream(&quot;E:\\fileName.txt&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 通过 stream 获取 FileChannel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileChannel channel = stream.getChannel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 创建一个缓冲区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ByteBuffer buffer = ByteBuffer.allocate(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 将 name 放入到 buffer中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        buffer.put(name.getBytes(StandardCharsets.UTF_8));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 对 buffer 进行 flip，即读写转换</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        buffer.flip();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 将 buffer 写入到 channel 中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        channel.write(buffer);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        channel.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_er05" id="本地文件读取">本地文件读取<a href="#本地文件读取" class="hash-link" aria-label="Direct link to 本地文件读取" title="Direct link to 本地文件读取">​</a></h5><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">package io.mvvm.nio.channel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.FileInputStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.ByteBuffer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.channels.FileChannel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @program: Netty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @description: FileChannel 读取</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author: 潘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @create: 2021-01-17 20:58</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> **/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class FileChannelReadExample {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 创建文件输入流</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileInputStream stream = new FileInputStream(&quot;\\fileName.txt&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 通过 stream 获取 FileChannel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileChannel channel = stream.getChannel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 创建一个缓冲区</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ByteBuffer buffer = ByteBuffer.allocate(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 将通道的数据读取到 buffer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        channel.read(buffer);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 将 buffer 转为 string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(new String(buffer.array()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        channel.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_er05" id="文件读取并写入">文件读取并写入<a href="#文件读取并写入" class="hash-link" aria-label="Direct link to 文件读取并写入" title="Direct link to 文件读取并写入">​</a></h5><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">package io.mvvm.nio.channel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.FileInputStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.FileOutputStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.ByteBuffer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.channels.FileChannel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @program: Netty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @description: FileChannel 文件拷贝</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author: 潘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @create: 2021-01-17 21:06</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> **/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class FileChannelCopyExample {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileInputStream inputStream = new FileInputStream(&quot;E:\\work\\Netty\\nio\\src\\main\\resources\\fileName.txt&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileChannel inputStreamChannel = inputStream.getChannel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileOutputStream outputStream = new FileOutputStream(&quot;E:\\work\\Netty\\nio\\src\\main\\resources\\fileName2.txt&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileChannel outputStreamChannel = outputStream.getChannel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ByteBuffer buffer = ByteBuffer.allocate(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 循环读取</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 清除 buffer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            buffer.clear();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int read = inputStreamChannel.read(buffer);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (read == -1) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 读取完毕</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 将 buffer 中数据写入到 outputStreamChannel 中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 读写转换</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            buffer.flip();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            outputStreamChannel.write(buffer);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        outputStreamChannel.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        inputStreamChannel.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_er05" id="文件拷贝-transferfrom">文件拷贝 transferFrom<a href="#文件拷贝-transferfrom" class="hash-link" aria-label="Direct link to 文件拷贝 transferFrom" title="Direct link to 文件拷贝 transferFrom">​</a></h5><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">package io.mvvm.nio.channel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.FileInputStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.FileOutputStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.channels.FileChannel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @program: Netty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @description: transferFrom 文件拷贝</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author: 潘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @create: 2021-01-17 21:15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> **/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class FileChannelTransferFromExample {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 创建流</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileInputStream inputStream = new FileInputStream(&quot;E:\\work\\Netty\\nio\\src\\main\\resources\\fileName.txt&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileOutputStream outputStream = new FileOutputStream(&quot;E:\\work\\Netty\\nio\\src\\main\\resources\\fileName1.txt&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 获取对应流的 channel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileChannel inputStreamChannel = inputStream.getChannel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FileChannel outputStreamChannel = outputStream.getChannel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 使用 transferFrom 进行拷贝</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        outputStreamChannel.transferFrom(inputStreamChannel, 0, inputStreamChannel.size());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 关闭资源</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        inputStreamChannel.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        outputStreamChannel.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        outputStream.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        inputStream.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_er05" id="注意事项和细节">注意事项和细节<a href="#注意事项和细节" class="hash-link" aria-label="Direct link to 注意事项和细节" title="Direct link to 注意事项和细节">​</a></h3><h4 class="anchor anchorWithStickyNavbar_er05" id="类型注意">类型注意<a href="#类型注意" class="hash-link" aria-label="Direct link to 类型注意" title="Direct link to 类型注意">​</a></h4><p>ByteBuffer 支持类型化的 put 和get，put时放入的是什么数据类型，get时就应该使用对应的数据类型取出，否则可能有 <code>BufferUnderflowException</code> 异常</p><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">ByteBuffer buffer = ByteBuffer.allocate(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">buffer.putShort((short) 10);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">buffer.flip();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">buffer.getInt();</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_er05" id="普通-buffer-转只读-buffer">普通 Buffer 转只读 Buffer<a href="#普通-buffer-转只读-buffer" class="hash-link" aria-label="Direct link to 普通 Buffer 转只读 Buffer" title="Direct link to 普通 Buffer 转只读 Buffer">​</a></h4><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">ByteBuffer buffer = ByteBuffer.allocate(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">buffer.put(&quot;zhangsan&quot;.getBytes(StandardCharsets.UTF_8));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 读取</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">buffer.flip();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 得到一个只读的 buffer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ByteBuffer readOnlyBuffer = buffer.asReadOnlyBuffer();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.out.println(readOnlyBuffer.getClass());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 读取</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">while (readOnlyBuffer.hasRemaining()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(readOnlyBuffer.get());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 此段代码将会抛出异常</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Exception in thread &quot;main&quot; java.nio.ReadOnlyBufferException</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">readOnlyBuffer.put(&quot;lisi&quot;.getBytes(StandardCharsets.UTF_8));</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_er05" id="mappedbytebuffer">MappedByteBuffer<a href="#mappedbytebuffer" class="hash-link" aria-label="Direct link to MappedByteBuffer" title="Direct link to MappedByteBuffer">​</a></h4><p>NIO 提供了 MappedByteBuffer，可以让文件直接在内存（堆外的内存）中进行修改，而如何同步到文件中由 NIO 来完成</p><h4 class="anchor anchorWithStickyNavbar_er05" id="scattering-和-gathering">Scattering 和 Gathering<a href="#scattering-和-gathering" class="hash-link" aria-label="Direct link to Scattering 和 Gathering" title="Direct link to Scattering 和 Gathering">​</a></h4><p>前面的读写操作都是通过一个 Buffer 完成的，NIO 还支持通过多个 Buffer （Buffer数组）完成读写操作</p><h3 class="anchor anchorWithStickyNavbar_er05" id="selector-选择器">Selector 选择器<a href="#selector-选择器" class="hash-link" aria-label="Direct link to Selector 选择器" title="Direct link to Selector 选择器">​</a></h3><h4 class="anchor anchorWithStickyNavbar_er05" id="什么是-selector">什么是 Selector<a href="#什么是-selector" class="hash-link" aria-label="Direct link to 什么是 Selector" title="Direct link to 什么是 Selector">​</a></h4><p>Java 的 NIO 使用非阻塞的 IO 方式。 Selector（选择器）可以用一个线程处理多个客户端连接</p><p>Selector 能够检测多个注册的通道上是否有事件发生（多个事件的方式可以注册到同一个Selector），如果有事件发生，便获取事件然后针对每个事件进行相应处理。这样就可以只用一个单线程去管理多个通道，也就是管理多个连接和请求。</p><p>只有在 连接/通道 真正有读写事件发生时，才会进行读写，这样就大大的减少了系统开销，并且不必为每个连接都创建一个线程，不用去维护多个线程</p><h4 class="anchor anchorWithStickyNavbar_er05" id="selector-类相关方法">Selector 类相关方法<a href="#selector-类相关方法" class="hash-link" aria-label="Direct link to Selector 类相关方法" title="Direct link to Selector 类相关方法">​</a></h4><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">public abstract class Selector implements Closeable {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 得到一个选择器对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static Selector open() throws IOException {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 监控所有注册的通道，当其中有IO操作可以进行时，将对应的加入到内部稽核中并返回，参数用来设置超时时间</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public abstract int select(long timeout) throws IOException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 从内部集合中获得到所有的 SelectionKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public abstract Set&lt;SelectionKey&gt; selectedKeys();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>NIO 中的 ServerSocketChannel 功能类似于 ServerSocket，SocketChannel  功能类似于 Socket</p><p>Selector相关方法说明：</p><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">selector.select(); // 阻塞</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">selector.select(1000); // 阻塞1000毫秒，在1000毫秒后返回</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">selector.wakeup(); // 唤醒 Selector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">selector.selectNow(); //步阻塞，立马返回</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_er05" id="nio-快速入门">NIO 快速入门<a href="#nio-快速入门" class="hash-link" aria-label="Direct link to NIO 快速入门" title="Direct link to NIO 快速入门">​</a></h3><p>编写一个服务端</p><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">package io.mvvm.nio.demo;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.IOException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.net.InetSocketAddress;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.ByteBuffer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.channels.SelectionKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.channels.Selector;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.channels.ServerSocketChannel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.channels.SocketChannel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Iterator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Set;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class NioServer {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 创建 ServerSocketChannel -&gt; ServerSocket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 得到一个Selecor对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Selector selector = Selector.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 绑定一个端口 ，在服务器端监听</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        serverSocketChannel.socket().bind(new InetSocketAddress(6666));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 设置为非阻塞</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        serverSocketChannel.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 吧 serverSocketChannel 注册到 selector 并且事件设置为 OP_ACCEPT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 等待客户端连接</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 等待一秒，如果没有事件发生则返回</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (selector.select(1000) == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.out.println(&quot;服务器等待了1秒，无连接&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                continue;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 如果返回的大于0，就获取到相关的selectionKey集合</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 1、如果返回的大于0，表示已经获取到关注的事件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 2、selector.selectedKeys() 返回关注事件的集合</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 通过 selectionKeys 反向获取通道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Set&lt;SelectionKey&gt; selectionKeys = selector.selectedKeys();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Iterator&lt;SelectionKey&gt; keyIterator = selectionKeys.iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (keyIterator.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 获取到SelectionKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SelectionKey key = keyIterator.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 根据Key对应的通道发生的事件做相应处理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 如果是 OP_ACCEPT，有新的客户端连接</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (key.isAcceptable()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // 该客户端生成一个SocketChannel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    SocketChannel socketChannel = serverSocketChannel.accept();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    System.out.println(&quot;客户端连接成功，生成了一个 socketChannel：&quot; + socketChannel.hashCode());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // 将 SocketChannel 设置为非阻塞</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    socketChannel.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // 关闭socketChannel注册到selector，关注事件为OP_READ，同时给 socketChannel 关联一个 Buffer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    socketChannel.register(selector, SelectionKey.OP_READ, ByteBuffer.allocate(1024));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 发生OP_READ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (key.isReadable()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // 通过key 反向获取对应的channel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    SocketChannel channel = (SocketChannel) key.channel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // 获取到该channel关联的buffer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    ByteBuffer buffer = (ByteBuffer) key.attachment();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    channel.read(buffer);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    System.out.println(&quot;form 客户端：&quot; + new String(buffer.array()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 手动从集合中移除当前的selectionKey，防止重复操作</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                keyIterator.remove();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>编写一个客户端</p><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">package io.mvvm.nio.demo;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.IOException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.net.InetSocketAddress;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.ByteBuffer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.channels.SocketChannel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.charset.StandardCharsets;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class NioClient {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 得到一个网络通道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SocketChannel socketChannel = SocketChannel.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 设置非阻塞</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socketChannel.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 提供服务器端的ip和端口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        InetSocketAddress inetSocketAddress = new InetSocketAddress(&quot;127.0.0.1&quot;, 6666);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 连接服务器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (!socketChannel.connect(inetSocketAddress)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (!socketChannel.finishConnect()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.out.println(&quot;因为连接需要时间，客户端不会阻塞，可以做其他工作...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 如果连接成功就发送数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String sendMessage = &quot;Hello Server&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ByteBuffer buffer = ByteBuffer.wrap(sendMessage.getBytes(StandardCharsets.UTF_8));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 发送数据，将buffer数据写入channel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socketChannel.write(buffer);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.in.read();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_er05" id="selectionkey">SelectionKey<a href="#selectionkey" class="hash-link" aria-label="Direct link to SelectionKey" title="Direct link to SelectionKey">​</a></h4><blockquote><p>SelectionKey 表示 Selector 和 网络通道的注册关系，一共有四种</p></blockquote><p><code>int OP_ACCEPT</code>：有新的网络连接可以 accept，值为16
<code>int OP_CONNECT</code>：代表连接已经建立，值为8
<code>int OP_READ</code>：代表读操作，值为1
<code>int OP_WRITE</code>：代表写操作，值为4</p><ul><li>相关方法 *</li></ul><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">// 得到与之关联的 Selector 对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public abstract Selector selector();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 得到与之关联的通道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public abstract SelectableChannel channel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 得到与之关联的共享数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public final Object attachment();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 设置或改变监听事件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public abstract SelectionKey interestOps(int ops);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 是否可以 accept</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public final boolean isAcceptable();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 是否可以读</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public final boolean isReadable();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 是否可以写</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public final boolean isWritable();</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_er05" id="serversocketchannel">ServerSocketChannel<a href="#serversocketchannel" class="hash-link" aria-label="Direct link to ServerSocketChannel" title="Direct link to ServerSocketChannel">​</a></h4><blockquote><p>在服务器端监听心的客户端 Socket 连接</p></blockquote><ul><li>相关方法 *</li></ul><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">// 得到一个 ServerSocketChannel 通道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static ServerSocketChannel open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 设置服务器端的端口号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public final ServerSocketChannel bind(SocketAddress local);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 设置阻塞或非阻塞模式，false表示采用非阻塞模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public final SelectableChannel configureBlocking(boolean block);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 接收一个连接，返回代表这个连接的通道对象</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public SocketChannel accept();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 注册一个选择器并设置监听事件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public final SelectionKey register(Selector sel, int ops);</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_er05" id="socketchannel">SocketChannel<a href="#socketchannel" class="hash-link" aria-label="Direct link to SocketChannel" title="Direct link to SocketChannel">​</a></h4><blockquote><p>SocketChannel 网络 IO 通道，具体负责进行读写操作，NIO 把缓冲区的数据写入通道，或者把通道里的数据读到缓冲区</p></blockquote><ul><li>相关方法 *</li></ul><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">// 得到一个 SocketChannel 通道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public static SocketChannel open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 设置阻塞或非阻塞模式，false表示采用非阻塞模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public final SelectableChannel configureBlocking(boolean block);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 连接服务器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public abstract boolean connect(SocketAddress remote);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 如果上面的方法连接失败，接下来就要通过该方法完成连接操作</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public abstract boolean finishConnect();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 往通道里写数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public abstract int write(ByteBuffer src);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 从通道里读数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public abstract int read(ByteBuffer dst);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 注册一个选择器并设置监听事件，最后一个参数可以设置共享数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public abstract SelectionKey register(Selector sel, int ops, Object att)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 关闭通道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public final void close();</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_er05" id="编写一个群聊小应用">编写一个群聊小应用<a href="#编写一个群聊小应用" class="hash-link" aria-label="Direct link to 编写一个群聊小应用" title="Direct link to 编写一个群聊小应用">​</a></h3><blockquote><p>实现思路：</p><p>1、首先需要一个服务端，服务端主要实现接收客户端的信息，然后将消息转发给其他客户端</p><p>2、编写一个客户端，客户端主要用于接收服务器转发的消息以及发送消息到服务端</p></blockquote><h4 class="anchor anchorWithStickyNavbar_er05" id="服务端">服务端<a href="#服务端" class="hash-link" aria-label="Direct link to 服务端" title="Direct link to 服务端">​</a></h4><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">package io.mvvm.nio.group;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.IOException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.net.InetSocketAddress;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.ByteBuffer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.channels.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.charset.StandardCharsets;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Iterator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @program: Netty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @description: 群聊服务端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author: 潘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @create: 2021-03-13 14:31</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> **/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ChatServer {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 定义属性</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Selector selector;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private ServerSocketChannel listenChannel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final int PORT = 6667;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ChatServer() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 得到选择器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            selector = Selector.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // ServerSocketChannel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            listenChannel = ServerSocketChannel.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 绑定端口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            listenChannel.socket().bind(new InetSocketAddress(PORT));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 设置非阻塞模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            listenChannel.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 将listenChannel注册到 selector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            listenChannel.register(selector, SelectionKey.OP_ACCEPT);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (IOException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 监听</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void listen() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 循环处理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                int count = selector.select();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 有事件处理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if (count &gt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // 遍历得到 selectionKey 集合</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Iterator&lt;SelectionKey&gt; keyIterator = selector.selectedKeys().iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    while (keyIterator.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // 取出 selectionKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        SelectionKey key = keyIterator.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // 监听到 accept</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        if (key.isAcceptable()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            SocketChannel sc = listenChannel.accept();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            sc.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            // 将sc注册到seletor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            sc.register(selector, SelectionKey.OP_READ);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            System.out.println(sc.getRemoteAddress() + &quot;上线&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // 通道发送 read 事件，即通道是可读的状态</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        if (key.isReadable()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            readData(key);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // 删除当前key，防止重复处理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        keyIterator.remove();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 读取客户端消息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private void readData(SelectionKey key) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 取到关联的channel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SocketChannel channel = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 得到channel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            channel = (SocketChannel) key.channel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 创建buffer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ByteBuffer buffer = ByteBuffer.allocate(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int count = channel.read(buffer);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (count &gt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 把缓冲区的数据转为字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                String msg = new String(buffer.array());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.out.println(&quot;form 客户端：&quot; + msg);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 象其他的客户端转发消息（去掉自己）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                sendInfoToOtherClients(msg, channel);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (IOException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                System.out.println(channel.getRemoteAddress() + &quot;下线了...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 取消注册</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                key.cancel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 关闭通道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                channel.close();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } catch (IOException ioException) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ioException.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 转发消息给其他客户端（通道）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private void sendInfoToOtherClients(String msg, SocketChannel self) throws IOException{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;服务器转发消息中...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 遍历所有注册到Selector上的 SocketChannel并排除 self</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (SelectionKey key : selector.keys()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 通过key取出对应的socketChannel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Channel targetChannel = key.channel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 排除自己</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (targetChannel instanceof SocketChannel &amp;&amp; targetChannel != self) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 转型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                SocketChannel dest = (SocketChannel) targetChannel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 将msg存储到buffer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ByteBuffer buffer = ByteBuffer.wrap(msg.getBytes(StandardCharsets.UTF_8));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 将buffer的数据写入通道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                dest.write(buffer);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ChatServer server = new ChatServer();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server.listen();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_er05" id="客户端">客户端<a href="#客户端" class="hash-link" aria-label="Direct link to 客户端" title="Direct link to 客户端">​</a></h4><div class="language-java codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-java codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">package io.mvvm.nio.group;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.io.IOException;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.net.InetSocketAddress;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.ByteBuffer;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.channels.SelectionKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.channels.Selector;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.channels.SocketChannel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.charset.StandardCharsets;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Iterator;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.util.Scanner;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @program: Netty</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @description: 客户端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author: 潘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @create: 2021-03-13 14:51</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> **/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ChatClient {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 服务端的IP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final String HOST = &quot;127.0.0.1&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 服务端的端口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final int PORT = 6667;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Selector selector;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private SocketChannel socketChannel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private String username;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ChatClient() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        selector = Selector.open();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 连接服务端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socketChannel = SocketChannel.open(new InetSocketAddress(HOST, PORT));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 设置非阻塞</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socketChannel.configureBlocking(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 将 channel 注册到 selector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        socketChannel.register(selector, SelectionKey.OP_READ);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 得到username</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        username = socketChannel.getLocalAddress().toString().substring(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(username + &quot; is ok...&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 向服务端发送消息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void sendInfo(String info) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        info = username + &quot; 说： &quot; + info;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            socketChannel.write(ByteBuffer.wrap(info.getBytes(StandardCharsets.UTF_8)));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (IOException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 读取从服务端回复的消息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void readInfo() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            int readChannels = selector.select();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 有可用的通道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (readChannels &gt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Iterator&lt;SelectionKey&gt; iterator = selector.selectedKeys().iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                while (iterator.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    SelectionKey key = iterator.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (key.isReadable()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // 得到相关的通道</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        SocketChannel sc = (SocketChannel) key.channel();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // 得到一个 buffer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ByteBuffer buffer = ByteBuffer.allocate(1024);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // 读取</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        sc.read(buffer);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // 把读到的缓冲区的数据转为字符串</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        String msg = new String(buffer.array());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        System.out.println(&quot;得到消息：&quot;+msg.trim());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 删除当前的selectionKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                iterator.remove();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } catch (IOException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ChatClient client = new ChatClient();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 启动一个线程，每个3秒，读取从服务器发送数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new Thread(){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            public void run() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                while (true) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    client.readInfo();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        Thread.currentThread().sleep(3000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    } catch (InterruptedException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        e.printStackTrace();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }.start();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 发送数据到服务端</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Scanner scanner = new Scanner(System.in);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (scanner.hasNextLine()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(&quot;请输入发送的消息：&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String s = scanner.nextLine();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            client.sendInfo(s);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_er05" id="零拷贝">零拷贝<a href="#零拷贝" class="hash-link" aria-label="Direct link to 零拷贝" title="Direct link to 零拷贝">​</a></h3></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/pannanxu/wiki/docs/后端/JDK/Nio.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_rssB" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_ZTIL"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/后端/JDK/JDK源码"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">JDK 源码</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/后端/Linux"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Linux</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_a4zv thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#什么是-java-nio" class="table-of-contents__link toc-highlight">什么是 Java NIO</a></li><li><a href="#nio-和-bio-的比较" class="table-of-contents__link toc-highlight">NIO 和 BIO 的比较</a></li><li><a href="#缓冲区" class="table-of-contents__link toc-highlight">缓冲区</a></li><li><a href="#通道channel" class="table-of-contents__link toc-highlight">通道（Channel）</a></li><li><a href="#注意事项和细节" class="table-of-contents__link toc-highlight">注意事项和细节</a></li><li><a href="#selector-选择器" class="table-of-contents__link toc-highlight">Selector 选择器</a></li><li><a href="#nio-快速入门" class="table-of-contents__link toc-highlight">NIO 快速入门</a></li><li><a href="#编写一个群聊小应用" class="table-of-contents__link toc-highlight">编写一个群聊小应用</a></li><li><a href="#零拷贝" class="table-of-contents__link toc-highlight">零拷贝</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_TSiV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_TSiV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_TSiV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/pannanxu/wiki" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_TSiV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3e06b88d.js"></script>
<script src="/assets/js/main.e1a27cf4.js"></script>
</body>
</html>